{"title":"Get rid of the list null-checks","slug":"get-rid-of-the-list-null-checks","date":"2019-07-28T21:18:43.000Z","updated":"2019-08-18T07:43:06.149Z","comments":true,"path":"api/articles/get-rid-of-the-list-null-checks.json","excerpt":null,"covers":null,"content":"<p>During development of the legacy Java applications, we still have to deal with <code>null</code>. It’s possible to avoid it completly when we’re designing application from the scratch, applying proper code constructions, static code analysis and we’re consistent during code reviews. Nevertheless in majority of the cases we will encounter <code>null</code> in daily projects. We may even expect them in the method inputs and we have to be prepared for it. With the functional programming in Java we can deal with them in quite elegant way, but I often see people are not using features available nowadays.</p>\n<p>Let’s have a look at the following code snippet:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> List&lt;MyType&gt; <span class=\"title\">getList</span><span class=\"params\">(<span class=\"keyword\">final</span> List&lt;MyType&gt; list)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (list != <span class=\"keyword\">null</span> || list.isEmpty()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Collections.emptyList();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list</span><br><span class=\"line\">            .stream()</span><br><span class=\"line\">            .filter(...)</span><br><span class=\"line\">            .collect(Collectors.toList());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>In this example <code>list</code> can be <code>null</code>, so we have to perform null-check. We can also verify if the <code>list</code> is not empty once we’re sure it’s not <code>null</code> and return empty collection in that case. If the condition is not met, we’re converting list to the stream and start processing it.</p>\n<p>We can use <code>CollectionUtils</code> from Apache Commons library to perform exactly the same check if we have it in our project dependencies:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> List&lt;MyType&gt; <span class=\"title\">getList</span><span class=\"params\">(<span class=\"keyword\">final</span> List&lt;MyType&gt; list)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (CollectionUtils.isEmpty(list)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Collections.emptyList();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list</span><br><span class=\"line\">            .stream()</span><br><span class=\"line\">            .filter(...)</span><br><span class=\"line\">            .collect(Collectors.toList());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>We can try to figure out, how to achieve the same goal with functional programming concepts in Java and write the same logic within the single, fluent stream. We can call <code>Optional.ofNullable(...)</code> method because we know that our method argument can be <code>null</code>. Next, once we’ve got an <code>Optional</code> type, we can call <code>.orElseGet(...)</code> method and provide an object, which we want to return, when <code>nullable</code> value will be <code>null</code>. In this case, it will be an empty list. After that, we can fluently proceed with the stream processing.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> List&lt;MyType&gt; <span class=\"title\">getList</span><span class=\"params\">(<span class=\"keyword\">final</span> List&lt;MyType&gt; list)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> Optional</span><br><span class=\"line\">            .ofNullable(list)</span><br><span class=\"line\">            .orElseGet(Collections::emptyList)</span><br><span class=\"line\">            .stream()</span><br><span class=\"line\">            .filter(...)</span><br><span class=\"line\">            .collect(Collectors.toList());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Code snippet above looks much more elegant, it’s shorter, more concise and we have achieved our goal within a single stream without any additional <code>if</code> statements and without breaking chain of method invocations.</p>\n","more":"<p>During development of the legacy Java applications, we still have to deal with <code>null</code>. It’s possible to avoid it completly when we’re designing application from the scratch, applying proper code constructions, static code analysis and we’re consistent during code reviews. Nevertheless in majority of the cases we will encounter <code>null</code> in daily projects. We may even expect them in the method inputs and we have to be prepared for it. With the functional programming in Java we can deal with them in quite elegant way, but I often see people are not using features available nowadays.</p>\n<p>Let’s have a look at the following code snippet:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> List&lt;MyType&gt; <span class=\"title\">getList</span><span class=\"params\">(<span class=\"keyword\">final</span> List&lt;MyType&gt; list)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (list != <span class=\"keyword\">null</span> || list.isEmpty()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Collections.emptyList();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list</span><br><span class=\"line\">            .stream()</span><br><span class=\"line\">            .filter(...)</span><br><span class=\"line\">            .collect(Collectors.toList());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>In this example <code>list</code> can be <code>null</code>, so we have to perform null-check. We can also verify if the <code>list</code> is not empty once we’re sure it’s not <code>null</code> and return empty collection in that case. If the condition is not met, we’re converting list to the stream and start processing it.</p>\n<p>We can use <code>CollectionUtils</code> from Apache Commons library to perform exactly the same check if we have it in our project dependencies:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> List&lt;MyType&gt; <span class=\"title\">getList</span><span class=\"params\">(<span class=\"keyword\">final</span> List&lt;MyType&gt; list)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (CollectionUtils.isEmpty(list)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Collections.emptyList();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> list</span><br><span class=\"line\">            .stream()</span><br><span class=\"line\">            .filter(...)</span><br><span class=\"line\">            .collect(Collectors.toList());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>We can try to figure out, how to achieve the same goal with functional programming concepts in Java and write the same logic within the single, fluent stream. We can call <code>Optional.ofNullable(...)</code> method because we know that our method argument can be <code>null</code>. Next, once we’ve got an <code>Optional</code> type, we can call <code>.orElseGet(...)</code> method and provide an object, which we want to return, when <code>nullable</code> value will be <code>null</code>. In this case, it will be an empty list. After that, we can fluently proceed with the stream processing.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> List&lt;MyType&gt; <span class=\"title\">getList</span><span class=\"params\">(<span class=\"keyword\">final</span> List&lt;MyType&gt; list)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> Optional</span><br><span class=\"line\">            .ofNullable(list)</span><br><span class=\"line\">            .orElseGet(Collections::emptyList)</span><br><span class=\"line\">            .stream()</span><br><span class=\"line\">            .filter(...)</span><br><span class=\"line\">            .collect(Collectors.toList());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Code snippet above looks much more elegant, it’s shorter, more concise and we have achieved our goal within a single stream without any additional <code>if</code> statements and without breaking chain of method invocations.</p>\n","categories":[],"tags":[{"name":"java","path":"api/tags/java.json"}]}