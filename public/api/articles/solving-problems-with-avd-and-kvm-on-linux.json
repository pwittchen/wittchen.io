{"title":"Solving problems with AVD and KVM on Linux","slug":"solving-problems-with-avd-and-kvm-on-linux","date":"2018-08-16T20:01:06.000Z","updated":"2019-07-03T22:51:02.813Z","comments":true,"path":"api/articles/solving-problems-with-avd-and-kvm-on-linux.json","excerpt":null,"covers":null,"content":"<p>I installed Android SDK and Android Studio on my new ThinkPad T470s with Ubuntu Linux 18.04.1 LTS. As usual, I wanted to create a new Android phone emulator called AVD (Android Virtual Device). I was able to create a new device, but unfortunately I encoutered problems. After opening AVD window, I saw the error message…</p>\n<h2 id=\"dev-kvm-is-not-found\"><a href=\"#dev-kvm-is-not-found\" class=\"headerlink\" title=\"/dev/kvm is not found\"></a>/dev/kvm is not found</h2><p>KVM (Kernel-based Virtual Machine) is a full virtualization solution for Linux on x86 hardware containing virtualization extensions (Intel VT or AMD-V). In order to enable KVM, I needed to restart the computer and enter the BIOS by pressing <code>F1</code> key before the system boot. Next, I entered <code>Security</code> tab and enabled <code>Intel Virtualization Technology</code> and <code>Intel VT-d Feature</code>. Now, I could press <code>F10</code> to save, exit nad restart the computer. Unfortunately, that wasn’t the end of the story. I saw another error message…</p>\n<h2 id=\"dev-kvm-device-permission-denied\"><a href=\"#dev-kvm-device-permission-denied\" class=\"headerlink\" title=\"/dev/kvm device permission denied\"></a>/dev/kvm device permission denied</h2><p>Luckily, I found answer to this issue on <a href=\"https://stackoverflow.com/questions/37300811/android-studio-dev-kvm-device-permission-denied$\" target=\"_blank\" rel=\"noopener\">StackOverflow</a>. I just needed to install <code>qemu-kvm</code> and add my user to the <code>kvm</code> group.</p>\n<p>I installed required software:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install qemu-kvm</span><br></pre></td></tr></table></figure>\n\n<p>Then, checked the ownership of <code>/dev/kvm</code>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -al /dev/kvm</span><br></pre></td></tr></table></figure>\n\n<p>The user was root, the group kvm. To check which users are in the kvm group, I could use:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep kvm /etc/group</span><br></pre></td></tr></table></figure>\n\n<p>This returned:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kvm:x:some_number:</span><br></pre></td></tr></table></figure>\n\n<p>As there is nothing left to the final <code>:</code>, there are no users in the kvm group.</p>\n<p>To add the user <code>username</code> to the kvm group, I could use:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo adduser username kvm</span><br></pre></td></tr></table></figure>\n\n<p>I can check my <code>username</code>, by typing:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">whoami</span><br></pre></td></tr></table></figure>\n\n<p>Now, I could check group members once again with:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep kvm /etc/group</span><br></pre></td></tr></table></figure>\n\n<p>My user should be there. Next, I could just restart the machine, create new AVD, start it and everything worked! I could finally use my Android emulator. Optionally, if you still have a problem, you can call the following command:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo chown username /dev/kvm</span><br></pre></td></tr></table></figure>\n\n<p>and replace <code>username</code> with your username</p>\n<h2 id=\"References\"><a href=\"#References\" class=\"headerlink\" title=\"References\"></a>References</h2><ul>\n<li><a href=\"https://stackoverflow.com/questions/36527278/dev-kvm-not-found-error-on-windows-in-android-studio\" target=\"_blank\" rel=\"noopener\">https://stackoverflow.com/questions/36527278/dev-kvm-not-found-error-on-windows-in-android-studio</a></li>\n<li><a href=\"https://stackoverflow.com/questions/37300811/android-studio-dev-kvm-device-permission-denied\" target=\"_blank\" rel=\"noopener\">https://stackoverflow.com/questions/37300811/android-studio-dev-kvm-device-permission-denied</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine\" target=\"_blank\" rel=\"noopener\">https://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine</a></li>\n</ul>\n","more":"<p>I installed Android SDK and Android Studio on my new ThinkPad T470s with Ubuntu Linux 18.04.1 LTS. As usual, I wanted to create a new Android phone emulator called AVD (Android Virtual Device). I was able to create a new device, but unfortunately I encoutered problems. After opening AVD window, I saw the error message…</p>\n<h2 id=\"dev-kvm-is-not-found\"><a href=\"#dev-kvm-is-not-found\" class=\"headerlink\" title=\"/dev/kvm is not found\"></a>/dev/kvm is not found</h2><p>KVM (Kernel-based Virtual Machine) is a full virtualization solution for Linux on x86 hardware containing virtualization extensions (Intel VT or AMD-V). In order to enable KVM, I needed to restart the computer and enter the BIOS by pressing <code>F1</code> key before the system boot. Next, I entered <code>Security</code> tab and enabled <code>Intel Virtualization Technology</code> and <code>Intel VT-d Feature</code>. Now, I could press <code>F10</code> to save, exit nad restart the computer. Unfortunately, that wasn’t the end of the story. I saw another error message…</p>\n<h2 id=\"dev-kvm-device-permission-denied\"><a href=\"#dev-kvm-device-permission-denied\" class=\"headerlink\" title=\"/dev/kvm device permission denied\"></a>/dev/kvm device permission denied</h2><p>Luckily, I found answer to this issue on <a href=\"https://stackoverflow.com/questions/37300811/android-studio-dev-kvm-device-permission-denied$\" target=\"_blank\" rel=\"noopener\">StackOverflow</a>. I just needed to install <code>qemu-kvm</code> and add my user to the <code>kvm</code> group.</p>\n<p>I installed required software:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install qemu-kvm</span><br></pre></td></tr></table></figure>\n\n<p>Then, checked the ownership of <code>/dev/kvm</code>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -al /dev/kvm</span><br></pre></td></tr></table></figure>\n\n<p>The user was root, the group kvm. To check which users are in the kvm group, I could use:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep kvm /etc/group</span><br></pre></td></tr></table></figure>\n\n<p>This returned:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kvm:x:some_number:</span><br></pre></td></tr></table></figure>\n\n<p>As there is nothing left to the final <code>:</code>, there are no users in the kvm group.</p>\n<p>To add the user <code>username</code> to the kvm group, I could use:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo adduser username kvm</span><br></pre></td></tr></table></figure>\n\n<p>I can check my <code>username</code>, by typing:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">whoami</span><br></pre></td></tr></table></figure>\n\n<p>Now, I could check group members once again with:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep kvm /etc/group</span><br></pre></td></tr></table></figure>\n\n<p>My user should be there. Next, I could just restart the machine, create new AVD, start it and everything worked! I could finally use my Android emulator. Optionally, if you still have a problem, you can call the following command:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo chown username /dev/kvm</span><br></pre></td></tr></table></figure>\n\n<p>and replace <code>username</code> with your username</p>\n<h2 id=\"References\"><a href=\"#References\" class=\"headerlink\" title=\"References\"></a>References</h2><ul>\n<li><a href=\"https://stackoverflow.com/questions/36527278/dev-kvm-not-found-error-on-windows-in-android-studio\" target=\"_blank\" rel=\"noopener\">https://stackoverflow.com/questions/36527278/dev-kvm-not-found-error-on-windows-in-android-studio</a></li>\n<li><a href=\"https://stackoverflow.com/questions/37300811/android-studio-dev-kvm-device-permission-denied\" target=\"_blank\" rel=\"noopener\">https://stackoverflow.com/questions/37300811/android-studio-dev-kvm-device-permission-denied</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine\" target=\"_blank\" rel=\"noopener\">https://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine</a></li>\n</ul>\n","categories":[],"tags":[{"name":"linux","path":"api/tags/linux.json"},{"name":"android","path":"api/tags/android.json"}]}