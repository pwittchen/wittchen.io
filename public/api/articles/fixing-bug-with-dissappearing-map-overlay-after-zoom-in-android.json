{"title":"Fixing bug with dissappearing map overlay after zoom in Android","slug":"fixing-bug-with-dissappearing-map-overlay-after-zoom-in-android","date":"2013-01-21T21:16:00.000Z","updated":"2019-07-03T22:51:02.810Z","comments":true,"path":"api/articles/fixing-bug-with-dissappearing-map-overlay-after-zoom-in-android.json","excerpt":null,"covers":null,"content":"<p>In Android 3.0 – HoneyComb (API 11) or higher occurs specific bug connected with map overlay. When we draw overlay on the map (e.g. routes, directions or polylines) after zooming to particular level, overlay disappear unexpectedly. We can fix this bug very easily by disabling hardware acceleration for drawing overlays. Below, you can see exemplary code snippet with map injected by RoboGuice and disabled hardware acceleration. Changing way of drawing overlays should fix the bug.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ExamplaryMapActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">RoboMapActivity</span> </span>&#123;</span><br><span class=\"line\">  \t<span class=\"meta\">@InjectView</span>(R.id.mapview)</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> MapView mapView;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle bundle)</span> </span>&#123;</span><br><span class=\"line\">\t\tenableHWAccel(mapView, <span class=\"keyword\">false</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@TargetApi</span>(<span class=\"number\">11</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">enableHWAccel</span><span class=\"params\">(MapView mapView, <span class=\"keyword\">boolean</span> enable)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> type = enable ? View.LAYER_TYPE_HARDWARE : View.LAYER_TYPE_SOFTWARE;</span><br><span class=\"line\">\t\t\tmapView.setLayerType(View.LAYER_TYPE_SOFTWARE, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","more":"<p>In Android 3.0 – HoneyComb (API 11) or higher occurs specific bug connected with map overlay. When we draw overlay on the map (e.g. routes, directions or polylines) after zooming to particular level, overlay disappear unexpectedly. We can fix this bug very easily by disabling hardware acceleration for drawing overlays. Below, you can see exemplary code snippet with map injected by RoboGuice and disabled hardware acceleration. Changing way of drawing overlays should fix the bug.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ExamplaryMapActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">RoboMapActivity</span> </span>&#123;</span><br><span class=\"line\">  \t<span class=\"meta\">@InjectView</span>(R.id.mapview)</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> MapView mapView;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle bundle)</span> </span>&#123;</span><br><span class=\"line\">\t\tenableHWAccel(mapView, <span class=\"keyword\">false</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@TargetApi</span>(<span class=\"number\">11</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">enableHWAccel</span><span class=\"params\">(MapView mapView, <span class=\"keyword\">boolean</span> enable)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> type = enable ? View.LAYER_TYPE_HARDWARE : View.LAYER_TYPE_SOFTWARE;</span><br><span class=\"line\">\t\t\tmapView.setLayerType(View.LAYER_TYPE_SOFTWARE, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":[],"tags":[{"name":"java","path":"api/tags/java.json"},{"name":"android","path":"api/tags/android.json"}]}