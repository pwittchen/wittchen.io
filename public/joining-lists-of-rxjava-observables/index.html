<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Joining lists of RxJava Observables · Piotr Wittchen</title><meta name="description" content="Joining lists of RxJava Observables - Piotr Wittchen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400"><link rel="search" type="application/opensearchdescription+xml" href="http://wittchen.io/atom.xml" title="Piotr Wittchen"><link rel="alternate" href="/feed.xml" title="Piotr Wittchen" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><div>Piotr Wittchen</div></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/archives" target="_self" class="nav-list-link">WRITING</a></li><li class="nav-list-item"><a href="/code" target="_self" class="nav-list-link">CODE</a></li><li class="nav-list-item"><a href="/projects" target="_self" class="nav-list-link">PROJECTS</a></li><li class="nav-list-item"><a href="/talks" target="_self" class="nav-list-link">TALKS</a></li><li class="nav-list-item"><a href="/contact" target="_self" class="nav-list-link">CONTACT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Joining lists of RxJava Observables</h1><div class="post-info">May 15, 2017</div><div class="post-content"><p>In <a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="noopener">RxJava</a> we have a few operators for joining Observables. The most common are:</p>
<ul>
<li><a href="http://reactivex.io/documentation/operators/concat.html" target="_blank" rel="noopener">concat</a></li>
<li><a href="http://reactivex.io/documentation/operators/merge.html" target="_blank" rel="noopener">merge</a></li>
<li><a href="http://reactivex.io/documentation/operators/zip.html" target="_blank" rel="noopener">zip</a></li>
</ul>
<p>Take a look at the documentation in these links. It has <strong>interactive marble diagrams</strong> showing how the operators work on the streams. You can move marbles along the lines and see how the output stream changes. It really helps to understand how it works. Code snippets in this article are based on RxJava 2.1.0 with JUnit 4.12 and Google Truth 0.32 for unit tests. Let’s say, we have the following Observables:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Observable&lt;String&gt; <span class="title">emitNumbers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Observable.fromArray(<span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>).delay(<span class="number">1</span>, TimeUnit.SECONDS);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Observable&lt;String&gt; <span class="title">emitLetters</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Observable.fromArray(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We can merge them in the different ways.</p>
<h2 id="Concat"><a href="#Concat" class="headerlink" title="Concat"></a><a href="http://reactivex.io/documentation/operators/concat.html" target="_blank" rel="noopener">Concat</a></h2><p>Concat operator <em>emits the emissions from two or more Observables without interleaving them</em>. We can perform the following operation:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Observable&lt;String&gt; <span class="title">concatStreams</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Observable.concat(emitNumbers(), emitLetters());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The easiest way to verify, how this operator works, is to create exploratory unit test as follows:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shouldConcatStreams</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// given</span></span><br><span class="line">  Observable&lt;String&gt; observable = playground.concatStreams();</span><br><span class="line">  List&lt;String&gt; expectedValues = Arrays.asList(<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>,<span class="string">"4"</span>,<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>,<span class="string">"d"</span>);</span><br><span class="line">  List&lt;String&gt; joinedValues = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// when</span></span><br><span class="line">  observable.blockingSubscribe(s -&gt; joinedValues.add(s));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// then</span></span><br><span class="line">  assertThat(joinedValues).isEqualTo(expectedValues);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This operation can be represented graphically as well.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">         1 --- 2 --- 3 --- 4</span><br><span class="line">                  |</span><br><span class="line">         a --- b --- c --- d</span><br><span class="line">                  |</span><br><span class="line">                  |</span><br><span class="line">                concat</span><br><span class="line">                  |</span><br><span class="line">                 \|/</span><br><span class="line">1 -- 2 -- 3 -- 4 --- a -- b -- c -- d</span><br></pre></td></tr></table></figure>

<p>As we can see one stream is appended to another regardless of the execution time of both streams.</p>
<h2 id="Merge"><a href="#Merge" class="headerlink" title="Merge"></a><a href="http://reactivex.io/documentation/operators/merge.html" target="_blank" rel="noopener">Merge</a></h2><p>Merge operator <em>combines multiple Observables into one by merging their emissions</em>. Here we have a similar story, but changed operator:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Observable&lt;String&gt; <span class="title">mergeStreams</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Observable.merge(emitNumbers(), emitLetters());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We are writing another unit test:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shouldMergeStreams</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// given</span></span><br><span class="line">  Observable&lt;String&gt; observable = playground.mergeStreams();</span><br><span class="line">  List&lt;String&gt; expectedValues = Arrays.asList(<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>,<span class="string">"d"</span>,<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>,<span class="string">"4"</span>);</span><br><span class="line">  List&lt;String&gt; joinedValues = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// when</span></span><br><span class="line">  observable.blockingSubscribe(s -&gt; joinedValues.add(s));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// then</span></span><br><span class="line">  assertThat(joinedValues).isEqualTo(expectedValues);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Merge operation should look like that:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">         1 --- 2 --- 3 --- 4</span><br><span class="line">                  |</span><br><span class="line">         a --- b --- c --- d</span><br><span class="line">                  |</span><br><span class="line">                  |</span><br><span class="line">                merge</span><br><span class="line">                  |</span><br><span class="line">                 \|/</span><br><span class="line">a -- b -- c -- d --- 1 -- 2 -- 3 -- 4</span><br></pre></td></tr></table></figure>

<p>This operator doesn’t synchronize the streams and merges them as values are emitted. Numbers are emitted later than letters, so letters are placed in the beginning of the output stream. Try to manipulate marble on the interactive diagram on the <a href="http://reactivex.io" target="_blank" rel="noopener">reactivex.io</a> website to see how it should work.</p>
<h2 id="Zip"><a href="#Zip" class="headerlink" title="Zip"></a><a href="http://reactivex.io/documentation/operators/zip.html" target="_blank" rel="noopener">Zip</a></h2><p>The last operator, I’d like to discuss in this article is “Zip” operator. Zip <em>combines the emissions of multiple Observables together via a specified function and emit single items for each combination based on the results of this function</em>. In simple words, it waits until many observables are emitted and then combines them into a pair (or triple Observable, etc. in the case or more Observables). Now, we need to create a function, which will transform our streams and return combined stream.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Observable&lt;String&gt; <span class="title">zipStreams</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Observable.zip(emitNumbers(), emitLetters(),</span><br><span class="line">      (s1, s2) -&gt; String.format(<span class="string">"(%s,%s)"</span>, s1, s2));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Next, we can verify it with test as usual:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shouldZipStreams</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// given</span></span><br><span class="line">  Observable&lt;String&gt; observable = playground.zipStreams();</span><br><span class="line">  List&lt;String&gt; expectedValues = Arrays.asList(<span class="string">"(1,a)"</span>,<span class="string">"(2,b)"</span>,<span class="string">"(3,c)"</span>,<span class="string">"(4,d)"</span>);</span><br><span class="line">  List&lt;String&gt; joinedValues = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// when</span></span><br><span class="line">  observable.blockingSubscribe(s -&gt; joinedValues.add(s));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// then</span></span><br><span class="line">  assertThat(joinedValues).isEqualTo(expectedValues);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>and it can be represented graphically like that:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">       1 --- 2 --- 3 --- 4</span><br><span class="line">                |</span><br><span class="line">       a --- b --- c --- d</span><br><span class="line">                |</span><br><span class="line">                |</span><br><span class="line">               zip</span><br><span class="line">                |</span><br><span class="line">               \|/</span><br><span class="line">(1,a) -- (2,b) --- (3,c) -- (4,d)</span><br></pre></td></tr></table></figure>

<p>Now, we have pairs of merged streams.</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>Of course, RxJava is complicated library and these methods are not covering all possibilities of merging and combining the Observable streams. Neverhteless, examples in this article are quite basic and may help you to understand how mentioned operators work. After that we can apply the best operator to appropriate situation.</p>
<hr>
<p>Reference thread on StackOverflow: <a href="http://stackoverflow.com/questions/28843318/android-rxjava-joining-lists" target="_blank" rel="noopener">http://stackoverflow.com/questions/28843318/android-rxjava-joining-lists</a></p>
</div></article></div></main><footer><div class="paginator"><a href="/prefser-207/" class="prev">PREV</a><a href="/emitting-different-rxjava-observables-depending-on-the-condition-with-flatmap/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'wittchenio';
var disqus_identifier = 'joining-lists-of-rxjava-observables/';
var disqus_title = 'Joining lists of RxJava Observables';
var disqus_url = 'http://wittchen.io/joining-lists-of-rxjava-observables/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//undefined.disqus.com/count.js" async></script><div class="copyright"><p>© 2013 - 2019 <a href="http://wittchen.io">Piotr Wittchen</a></p><p><a href="https://github.com/pwittchen/wittchen.io">source</a> / <a href="https://stats.uptimerobot.com/ZwxAGU5rxy">uptime</a> / <a href="/feed.xml">rss</a> / <a href="/archives">writing</a> / <a href="/tags">tags</a> / <a href="https://github.com/pwittchen/wittchen.io#rest">api</a> / <a href="/gh">github</a> / <a href="/so">stackoverflow</a> / <a href="/in">linkedin</a> / <a href="mailto:piotr@wittchen.io">email</a></p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-2194664-7",'auto');ga('send','pageview');</script></body></html>