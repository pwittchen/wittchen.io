<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Separate execution of unit and integration tests in Gradle · Piotr Wittchen</title><meta name="description" content="Separate execution of unit and integration tests in Gradle - Piotr Wittchen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400"><link rel="search" type="application/opensearchdescription+xml" href="http://wittchen.io/atom.xml" title="Piotr Wittchen"><link rel="alternate" href="/feed.xml" title="Piotr Wittchen" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><div>Piotr Wittchen</div></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/archives" target="_self" class="nav-list-link">WRITING</a></li><li class="nav-list-item"><a href="/code" target="_self" class="nav-list-link">CODE</a></li><li class="nav-list-item"><a href="/projects" target="_self" class="nav-list-link">PROJECTS</a></li><li class="nav-list-item"><a href="/talks" target="_self" class="nav-list-link">TALKS</a></li><li class="nav-list-item"><a href="/contact" target="_self" class="nav-list-link">CONTACT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Separate execution of unit and integration tests in Gradle</h1><div class="post-info">Sep 22, 2018</div><div class="post-content"><p>During development process, we often write unit and integration tests. While unit tests verify corectness of the small pieces of code, integration tests verify software as a whole project and sometimes can treat it as a black box where concrete results are expected. During development of the REST API, we can write integration tests for such API with <a href="https://github.com/rest-assured/rest-assured" target="_blank" rel="noopener">REST Assured</a>. Integration tests are usually slower, because they need to start the server and sometimes do other stuff. That’s why it’s good to separate their execution from regular unit tests. On the CI server we can even have separate job for them.</p>
<p>We can define the following project structure:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+ src</span><br><span class="line">|</span><br><span class="line">+- main</span><br><span class="line">|  |</span><br><span class="line">|  +- java</span><br><span class="line">|    |</span><br><span class="line">|    +- com ...</span><br><span class="line">|</span><br><span class="line">+- test</span><br><span class="line">  |</span><br><span class="line">  +- java</span><br><span class="line">    |</span><br><span class="line">    +- com ... (unit tests)</span><br><span class="line">    |</span><br><span class="line">    +- integration (integration tests)</span><br></pre></td></tr></table></figure>

<p>In the <code>java/com/</code> directory we can put unit tests and in the <code>integration/</code> directory we can put integration tests.</p>
<p>Now, we can prepare the following configuration in the <code>build.gradle</code>:</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">test &#123;</span><br><span class="line">  <span class="keyword">if</span> (System.properties[<span class="string">'test.profile'</span>] != <span class="string">'integration'</span>) &#123;</span><br><span class="line">    <span class="keyword">exclude</span> <span class="string">'**/*integration*'</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">exclude</span> <span class="string">'**/*com/*'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>As you can see, when <code>test.profile</code> is different than <code>integration/</code>, we’re excluding <code>integration/</code> directory from tests. Otherwise, we’re excluding <code>com/</code> directory.</p>
<p>Now, when we want to execute unit tests only, we can type the following command:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew test</span><br></pre></td></tr></table></figure>

<p>but when we want to run unit test, we can type:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew test -Dtest.profile=integration</span><br></pre></td></tr></table></figure>

<p>When we want to execute all tests, we can redefine configuration above, write another gradle task or perform one execution after another:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew test &amp;&amp; ./gradlew test -Dtest.profile=integration</span><br></pre></td></tr></table></figure>

<p>That’s it!</p>
</div></article></div></main><footer><div class="paginator"><a href="/creating-fat-aar/" class="prev">PREV</a><a href="/excluding-generated-code-from-jacoco-report/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'wittchenio';
var disqus_identifier = 'separate-execution-of-unit-and-integration-tests-in-gradle/';
var disqus_title = 'Separate execution of unit and integration tests in Gradle';
var disqus_url = 'http://wittchen.io/separate-execution-of-unit-and-integration-tests-in-gradle/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//undefined.disqus.com/count.js" async></script><div class="copyright"><p>© 2013 - 2019 <a href="http://wittchen.io">Piotr Wittchen</a></p><p><a href="https://github.com/pwittchen/wittchen.io">source</a> / <a href="https://stats.uptimerobot.com/ZwxAGU5rxy">uptime</a> / <a href="/feed.xml">rss</a> / <a href="/archives">writing</a> / <a href="/tags">tags</a> / <a href="https://github.com/pwittchen/wittchen.io#rest">api</a> / <a href="/gh">github</a> / <a href="/so">stackoverflow</a> / <a href="/in">linkedin</a> / <a href="mailto:piotr@wittchen.io">email</a></p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-2194664-7",'auto');ga('send','pageview');</script></body></html>