<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Deployment of the Java code to AWS Lambda · Piotr Wittchen</title><meta name="description" content="Deployment of the Java code to AWS Lambda - Piotr Wittchen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400"><link rel="search" type="application/opensearchdescription+xml" href="http://wittchen.io/atom.xml" title="Piotr Wittchen"><link rel="alternate" href="/feed.xml" title="Piotr Wittchen" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><div>Piotr Wittchen</div></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/archives" target="_self" class="nav-list-link">WRITING</a></li><li class="nav-list-item"><a href="/code" target="_self" class="nav-list-link">CODE</a></li><li class="nav-list-item"><a href="/projects" target="_self" class="nav-list-link">PROJECTS</a></li><li class="nav-list-item"><a href="/talks" target="_self" class="nav-list-link">TALKS</a></li><li class="nav-list-item"><a href="/contact" target="_self" class="nav-list-link">CONTACT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Deployment of the Java code to AWS Lambda</h1><div class="post-info">Mar 18, 2018</div><div class="post-content"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In the cloud computing era, companies start using services like Google Cloud Platform, Amazon Web Services or Microsoft Azure. We can hear about the term “Serverless”. It doesn’t mean that we don’t have any servers. It means that third-party services provide us server infsrastrucutre, monitoring and scaling capabilities, so we don’t have to care about that stuff by ourselves and we can focus on writing code. We have concepts like Backend as a Service (BaaS) and Funtion as a Service (FaaS). In BaaS we can configure whole backend infrastructure using third-party cloud services. In this case, we can have database, REST API and other services, which we need depending on our use case. In FaaS, we have just a tiny piece of code responsible for a single job, which we can take and deploy into the cloud. AWS Lambda is an example of FaaS and we’ll focus on it in this article.</p>
<h2 id="AWS-Console"><a href="#AWS-Console" class="headerlink" title="AWS Console"></a>AWS Console</h2><p>First of all, we need to create our AWS account to have an access to AWS console. You can find the console at: <a href="https://aws.amazon.com/console/" target="_blank" rel="noopener">https://aws.amazon.com/console/</a>. I had a few problems regarding registration, but finally I created my account. People in support are quite helpful. Please, keep in mind the fact, that you need to provide your debit card details during the registration and they’ll charge you about 3 USD or something like that, which is a verification procedure. In AWS Lambda we’ll get 1 million of free requests per month per cloud function, which is enough for tests or even not so demanding commercial services.</p>
<h2 id="Serverless-Framework"><a href="#Serverless-Framework" class="headerlink" title="Serverless Framework"></a>Serverless Framework</h2><p><a href="https://serverless.com/" target="_blank" rel="noopener">Serverless Framework</a> is very convenient way of deploying Lambdas to AWS. You can install it as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install serverless -g</span><br></pre></td></tr></table></figure>

<p>Next, you can type:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serverless login</span><br></pre></td></tr></table></figure>

<p>in order to log into Serverless. We can use <code>serverless</code> or <code>sls</code> alias for this tool.</p>
<p>We also need to <strong>authorize</strong> Serverless to be able to deploy our Lambdas to AWS. We need to go to AWS Console, in the upper right corner click our name of the user and choose “My Security Credentials”. Then, we need to expand “Access Keys” and create new <code>key</code> and <code>secret</code> values. Once we got them, we can authorize Serverless:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sls config credentials --provider aws --key YOUR_KEY --secret YOUR_SECRET</span><br></pre></td></tr></table></figure>

<p>Serverless will store these credentials in <code>~./aws/credentials</code> file. Of course, this is very simple configruation. If we need more users, groups or more sophisticated authorization mechanisms, we should apply them later via IAM (Identity and Access Management) service.</p>
<h2 id="Creating-Lambda"><a href="#Creating-Lambda" class="headerlink" title="Creating Lambda"></a>Creating Lambda</h2><p>Next, we can create our AWS Lambda template. When, we type:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sls create --template</span><br></pre></td></tr></table></figure>

<p>We will see the list of available templates:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Serverless: Generating boilerplate...</span><br><span class="line"></span><br><span class="line">  Serverless Error ---------------------------------------</span><br><span class="line"></span><br><span class="line">  Template &quot;true&quot; is not supported. Supported templates are: &quot;aws-nodejs&quot;, </span><br><span class="line">  &quot;aws-nodejs-typescript&quot;, &quot;aws-nodejs-ecma-script&quot;, &quot;aws-python&quot;, </span><br><span class="line">  &quot;aws-python3&quot;, &quot;aws-groovy-gradle&quot;, &quot;aws-java-maven&quot;, </span><br><span class="line">  &quot;aws-java-gradle&quot;, &quot;aws-kotlin-jvm-maven&quot;, &quot;aws-kotlin-jvm-gradle&quot;, </span><br><span class="line">  &quot;aws-kotlin-nodejs-gradle&quot;, &quot;aws-scala-sbt&quot;, &quot;aws-csharp&quot;, &quot;aws-fsharp&quot;, </span><br><span class="line">  &quot;aws-go&quot;, &quot;aws-go-dep&quot;, &quot;azure-nodejs&quot;, &quot;google-nodejs&quot;, &quot;kubeless-python&quot;, </span><br><span class="line">  &quot;kubeless-nodejs&quot;, &quot;openwhisk-nodejs&quot;, &quot;openwhisk-php&quot;, &quot;openwhisk-python&quot;, </span><br><span class="line">  &quot;openwhisk-swift&quot;, &quot;spotinst-nodejs&quot;, &quot;spotinst-python&quot;, &quot;spotinst-ruby&quot;, </span><br><span class="line">  &quot;spotinst-java8&quot;, &quot;webtasks-nodejs&quot;, &quot;plugin&quot; and &quot;hello-world&quot;.</span><br><span class="line"></span><br><span class="line">  Get Support --------------------------------------------</span><br><span class="line">     Docs:          docs.serverless.com</span><br><span class="line">     Bugs:          github.com/serverless/serverless/issues</span><br><span class="line">     Forums:        forum.serverless.com</span><br><span class="line">     Chat:          gitter.im/serverless/serverless</span><br><span class="line"></span><br><span class="line">  Your Environment Information -----------------------------</span><br><span class="line">     OS:                     linux</span><br><span class="line">     Node Version:           7.10.1</span><br><span class="line">     Serverless Version:     1.26.0</span><br></pre></td></tr></table></figure>

<p>We will use <code>aws-java-gradle</code> template:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sls create --template aws-java-gradle</span><br></pre></td></tr></table></figure>

<p>After that, we’ll get the following project structure:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">├── build.gradle</span><br><span class="line">├── gradle</span><br><span class="line">│   └── wrapper</span><br><span class="line">│       ├── gradle-wrapper.jar</span><br><span class="line">│       └── gradle-wrapper.properties</span><br><span class="line">├── gradlew</span><br><span class="line">├── gradlew.bat</span><br><span class="line">├── serverless.yml</span><br><span class="line">└── src</span><br><span class="line">    └── main</span><br><span class="line">        ├── java</span><br><span class="line">        │   └── com</span><br><span class="line">        │       └── serverless</span><br><span class="line">        │           ├── ApiGatewayResponse.java</span><br><span class="line">        │           ├── Handler.java</span><br><span class="line">        │           └── Response.java</span><br><span class="line">        └── resources</span><br><span class="line">            └── log4j.properties</span><br></pre></td></tr></table></figure>

<p>If you want to browse source of such template, you can visit my <a href="https://github.com/pwittchen/serverless-lambda-playground" target="_blank" rel="noopener">serverless-lambda-playground</a> repo.<br>We can add our configurations in <code>serverless.yml</code> file:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">service:</span> <span class="string">aws-java-gradle</span></span><br><span class="line"></span><br><span class="line"><span class="attr">provider:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">aws</span></span><br><span class="line"><span class="attr">  runtime:</span> <span class="string">java8</span></span><br><span class="line"></span><br><span class="line"><span class="attr">package:</span></span><br><span class="line"><span class="attr">  artifact:</span> <span class="string">build/distributions/hello.zip</span></span><br><span class="line"></span><br><span class="line"><span class="attr">functions:</span></span><br><span class="line"><span class="attr">  hello:</span></span><br><span class="line"><span class="attr">    handler:</span> <span class="string">com.serverless.Handler</span></span><br></pre></td></tr></table></figure>

<p>Main class is the <code>Handler</code> class:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Handler</span> <span class="keyword">implements</span> <span class="title">RequestHandler</span>&lt;<span class="title">Map</span>&lt;<span class="title">String</span>, <span class="title">Object</span>&gt;, <span class="title">ApiGatewayResponse</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOG = Logger.getLogger(Handler.class);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> ApiGatewayResponse <span class="title">handleRequest</span><span class="params">(Map&lt;String, Object&gt; input, Context context)</span> </span>&#123;</span><br><span class="line">	LOG.info(<span class="string">"received: "</span> + input);</span><br><span class="line">	Response responseBody = <span class="keyword">new</span> Response(<span class="string">"Go Serverless v1.x! </span></span><br><span class="line"><span class="string">	Your function executed successfully!"</span>, input);</span><br><span class="line">	<span class="keyword">return</span> ApiGatewayResponse.builder()</span><br><span class="line">			.setStatusCode(<span class="number">200</span>)</span><br><span class="line">			.setObjectBody(responseBody)</span><br><span class="line">			.setHeaders(Collections.singletonMap(<span class="string">"X-Powered-By"</span>, </span><br><span class="line">			<span class="string">"AWS Lambda &amp; serverless"</span>))</span><br><span class="line">			.build();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We can modify <code>handleRequest(Map&lt;String, Object&gt; input, Context context)</code> in order to perform any operation we want. It will be invoked after calling the Lambda.<br>In case of JVM projects, we need to build them first:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew build</span><br></pre></td></tr></table></figure>

<h2 id="Deployment-to-the-Cloud"><a href="#Deployment-to-the-Cloud" class="headerlink" title="Deployment to the Cloud"></a>Deployment to the Cloud</h2><p>Next, we can deploy our Lambda to the AWS Cloud!</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sls deploy</span><br></pre></td></tr></table></figure>

<p>It may take more time in the beginning, but updates should be faster.</p>
<p>We should see something like that:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Serverless: Packaging service...</span><br><span class="line">Serverless: Creating Stack...</span><br><span class="line">Serverless: Checking Stack create progress...</span><br><span class="line">.....</span><br><span class="line">Serverless: Stack create finished...</span><br><span class="line">Serverless: Uploading CloudFormation file to S3...</span><br><span class="line">Serverless: Uploading artifacts...</span><br><span class="line">Serverless: Validating template...</span><br><span class="line">Serverless: Updating Stack...</span><br><span class="line">Serverless: Checking Stack update progress...</span><br><span class="line">...............</span><br><span class="line">Serverless: Stack update finished...</span><br><span class="line">Service Information</span><br><span class="line">service: aws-java-gradle</span><br><span class="line">stage: dev</span><br><span class="line">region: us-east-1</span><br><span class="line">stack: aws-java-gradle-dev</span><br><span class="line">api keys:</span><br><span class="line">  None</span><br><span class="line">endpoints:</span><br><span class="line">  None</span><br><span class="line">functions:</span><br><span class="line">  hello: aws-java-gradle-dev-hello</span><br><span class="line">Serverless: Publish service to Serverless Platform...</span><br><span class="line">Service successfully published! Your service details are available at:</span><br><span class="line">https://platform.serverless.com/services/pwittchen/aws-java-gradle</span><br></pre></td></tr></table></figure>

<p>Since that moment, our Lambda is deployed!</p>
<p>Be aware of the regions! I’m beginner with AWS, so I haven’t noticed that my Lambda was deployed to <code>us-east-1</code> and I was checking it on the AWS console, while being switched to another region and I didn’t know why I cannot see my function.</p>
<p>Now, we can log into AWS Console and Navigate to Lambda and then to Functions. We should see our function:</p>
<p><img src="/images/posts/2018/deployment-of-the-java-code-to-aws-lambda/lambda-console.png" alt></p>
<p>When, we type:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sls info</span><br></pre></td></tr></table></figure>

<p>We should see information about the Lambda:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Service Information</span><br><span class="line">service: aws-java-gradle</span><br><span class="line">stage: dev</span><br><span class="line">region: us-east-1</span><br><span class="line">stack: aws-java-gradle-dev</span><br><span class="line">api keys:</span><br><span class="line">  None</span><br><span class="line">endpoints:</span><br><span class="line">  None</span><br><span class="line">functions:</span><br><span class="line">  hello: aws-java-gradle-dev-hello</span><br></pre></td></tr></table></figure>

<p>We can view details of our Lambda in AWS Console.</p>
<p><img src="/images/posts/2018/deployment-of-the-java-code-to-aws-lambda/lambda-details.png" alt></p>
<h2 id="Exposing-Lambda-via-API-Gateway"><a href="#Exposing-Lambda-via-API-Gateway" class="headerlink" title="Exposing Lambda via API Gateway"></a>Exposing Lambda via API Gateway</h2><p>We can also apply API Gateway to expose our Lambda to the external world.</p>
<p><img src="/images/posts/2018/deployment-of-the-java-code-to-aws-lambda/api-gateway.png" alt></p>
<p>We can make our endpoint open or secured.</p>
<p>Next, we can expand Gateway details and we should find “Invoke URL”. </p>
<p>We can call it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://ipj76pb5yl.execute-api.us-east-1.amazonaws.com/prod/aws-java-gradle-dev-hello</span><br></pre></td></tr></table></figure>

<p>Of course, url will be different in your setup.</p>
<p>After that, we should receive response:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"message"</span>: <span class="string">"Go Serverless v1.x! Your function executed successfully!"</span>,</span><br><span class="line">  <span class="attr">"input"</span>: &#123;</span><br><span class="line">    <span class="attr">"resource"</span>: <span class="string">"/aws-java-gradle-dev-hello"</span>,</span><br><span class="line">    <span class="attr">"path"</span>: <span class="string">"/aws-java-gradle-dev-hello"</span>,</span><br><span class="line">    <span class="attr">"httpMethod"</span>: <span class="string">"GET"</span>,</span><br><span class="line">    <span class="attr">"headers"</span>: &#123;</span><br><span class="line">      <span class="attr">"Accept"</span>: <span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"</span>,</span><br><span class="line">      <span class="attr">"Accept-Encoding"</span>: <span class="string">"gzip, deflate, br"</span>,</span><br><span class="line">      <span class="attr">"Accept-Language"</span>: <span class="string">"en-US,en;q=0.5"</span>,</span><br><span class="line">      <span class="attr">"CloudFront-Forwarded-Proto"</span>: <span class="string">"https"</span>,</span><br><span class="line">      <span class="attr">"CloudFront-Is-Desktop-Viewer"</span>: <span class="string">"true"</span>,</span><br><span class="line">      <span class="attr">"CloudFront-Is-Mobile-Viewer"</span>: <span class="string">"false"</span>,</span><br><span class="line">      <span class="attr">"CloudFront-Is-SmartTV-Viewer"</span>: <span class="string">"false"</span>,</span><br><span class="line">      <span class="attr">"CloudFront-Is-Tablet-Viewer"</span>: <span class="string">"false"</span>,</span><br><span class="line">      <span class="attr">"CloudFront-Viewer-Country"</span>: <span class="string">"PL"</span>,</span><br><span class="line">      <span class="attr">"Host"</span>: <span class="string">"ipj76pb5yl.execute-api.us-east-1.amazonaws.com"</span>,</span><br><span class="line">      <span class="attr">"upgrade-insecure-requests"</span>: <span class="string">"1"</span>,</span><br><span class="line">      <span class="attr">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0"</span>,</span><br><span class="line">      <span class="attr">"Via"</span>: <span class="string">"2.0 a9e1c5fff6a2739d3f7026c216819292.cloudfront.net (CloudFront)"</span>,</span><br><span class="line">      <span class="attr">"X-Amz-Cf-Id"</span>: <span class="string">"mU9mJ_nnAMYSbqz_Iu2otYdSAG7wgW32HeVLGV388duttalquBZAHA=="</span>,</span><br><span class="line">      <span class="attr">"X-Amzn-Trace-Id"</span>: <span class="string">"Root=1-5aae6481-c429ef02c5f6dd6f25c4526a"</span>,</span><br><span class="line">      <span class="attr">"X-Forwarded-For"</span>: <span class="string">"85.14.99.231, 54.182.243.105"</span>,</span><br><span class="line">      <span class="attr">"X-Forwarded-Port"</span>: <span class="string">"443"</span>,</span><br><span class="line">      <span class="attr">"X-Forwarded-Proto"</span>: <span class="string">"https"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"queryStringParameters"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"pathParameters"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"stageVariables"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"requestContext"</span>: &#123;</span><br><span class="line">      <span class="attr">"requestTime"</span>: <span class="string">"18/Mar/2018:13:07:13 +0000"</span>,</span><br><span class="line">      <span class="attr">"path"</span>: <span class="string">"/prod/aws-java-gradle-dev-hello"</span>,</span><br><span class="line">      <span class="attr">"accountId"</span>: <span class="string">"782268757726"</span>,</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"HTTP/1.1"</span>,</span><br><span class="line">      <span class="attr">"resourceId"</span>: <span class="string">"t56p8t"</span>,</span><br><span class="line">      <span class="attr">"stage"</span>: <span class="string">"prod"</span>,</span><br><span class="line">      <span class="attr">"requestTimeEpoch"</span>: <span class="number">1521378433902</span>,</span><br><span class="line">      <span class="attr">"requestId"</span>: <span class="string">"46b8b8fb-2aad-11e8-8a1b-0b0a282c605c"</span>,</span><br><span class="line">      <span class="attr">"identity"</span>: &#123;</span><br><span class="line">        <span class="attr">"cognitoIdentityPoolId"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">"accountId"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">"cognitoIdentityId"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">"caller"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">"sourceIp"</span>: <span class="string">"85.14.99.231"</span>,</span><br><span class="line">        <span class="attr">"accessKey"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">"cognitoAuthenticationType"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">"cognitoAuthenticationProvider"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">"userArn"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">"userAgent"</span>: <span class="string">"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0"</span>,</span><br><span class="line">        <span class="attr">"user"</span>: <span class="literal">null</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"resourcePath"</span>: <span class="string">"/aws-java-gradle-dev-hello"</span>,</span><br><span class="line">      <span class="attr">"httpMethod"</span>: <span class="string">"GET"</span>,</span><br><span class="line">      <span class="attr">"apiId"</span>: <span class="string">"ipj76pb5yl"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"body"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"isBase64Encoded"</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Hooray! Our Lambda is working on-line now!</p>
<h2 id="Monitoring"><a href="#Monitoring" class="headerlink" title="Monitoring"></a>Monitoring</h2><p>In the “Monitoring” section of the AWS Lambda Functions Console, we can monitor usage of our service.</p>
<p><img src="/images/posts/2018/deployment-of-the-java-code-to-aws-lambda/lambda-monitoring.png" alt></p>
<h2 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h2><p>If we want to update our function, we can simply modify it, rebuild code with <code>./gradlew build</code> and deploy it again with <code>sls deploy</code>. Once we have it configured it’s really easy.</p>
<h2 id="Function-Removal"><a href="#Function-Removal" class="headerlink" title="Function Removal"></a>Function Removal</h2><p>If we want to remove our Function, we can just type:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sls remove</span><br></pre></td></tr></table></figure>

<p>and we’ll see the following messages:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Serverless: Getting all objects in S3 bucket...</span><br><span class="line">Serverless: Removing objects in S3 bucket...</span><br><span class="line">Serverless: Removing Stack...</span><br><span class="line">Serverless: Checking Stack removal progress...</span><br><span class="line">.........</span><br><span class="line">Serverless: Stack removal finished...</span><br><span class="line">Serverless: Successfully archived your service on the Serverless Platform</span><br></pre></td></tr></table></figure>

<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>To wrap up, AWS Lambda is a really convenient way to solve single tasks without worrying about infrastructure, deployment and scalability. If we need one job to be done - e.g. exposing endpoint, transforming images, sending notifications, tiny app running on the server or whatever is required, AWS Lambda is good choice for that. Moreover, thanks to Serverless Framework deployment becomes really easy. In addition, we can develop Lambdas in other languages like Kotlin, Groovy, Scala, Go, Python, Node.js, C# and F#, so we’re not limited just to one language. We also should remember that AWS is powerfull platform with about 100 different services and Lambda is just one of them. It’s good to familiarize with AWS and other cloud computing platforms like Azure, GCP and so on because more companies start to invest in that and such solutions are becoming standard in certain areas.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a href="https://martinfowler.com/articles/serverless.html" target="_blank" rel="noopener">Serverless Architecture by Martin Fowler</a></li>
<li><a href="https://www.youtube.com/watch?v=71cd5XerKss" target="_blank" rel="noopener">AWS + Serverless - video tutorial</a></li>
<li><a href="https://console.aws.amazon.com" target="_blank" rel="noopener">AWS Console</a></li>
<li><a href="https://serverless.com/" target="_blank" rel="noopener">Serverless Framework</a></li>
<li><a href="https://github.com/pwittchen/serverless-lambda-playground" target="_blank" rel="noopener">Serverless Lambda Playground repository</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/avoiding-merging-master-to-master/" class="prev">PREV</a><a href="/introducing-reactive-bus/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'wittchenio';
var disqus_identifier = 'deployment-of-the-java-code-to-aws-lambda/';
var disqus_title = 'Deployment of the Java code to AWS Lambda';
var disqus_url = 'http://wittchen.io/deployment-of-the-java-code-to-aws-lambda/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//undefined.disqus.com/count.js" async></script><div class="copyright"><p>© 2013 - 2020 <a href="http://wittchen.io">Piotr Wittchen</a></p><p><a href="https://github.com/pwittchen/wittchen.io">source</a> / <a href="https://stats.uptimerobot.com/ZwxAGU5rxy">uptime</a> / <a href="/feed.xml">rss</a> / <a href="/archives">writing</a> / <a href="/tags">tags</a> / <a href="https://github.com/pwittchen/wittchen.io#rest">api</a> / <a href="/gh">github</a> / <a href="/so">stackoverflow</a> / <a href="/in">linkedin</a> / <a href="mailto:piotr@wittchen.io">email</a></p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-2194664-7",'auto');ga('send','pageview');</script></body></html>