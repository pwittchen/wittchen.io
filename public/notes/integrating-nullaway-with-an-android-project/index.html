<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Integrating ErrorProne and NullAway with an Android project | Piotr Wittchen</title><meta name=keywords content="java,android"><meta name=description content="Recently, with the remote help of guys from Uber in California, I integrated NullAway and ErrorProne with the one of my open-source Android projects.
What is NullAway?
Basically, it&rsquo;s a tool to help eliminate NullPointerExceptions (NPEs) in your Java code. It detects situations where NPE could occur at the compile time. Let&rsquo;s have a look at the following code:
static void log(Object x) {
    System.out.println(x.toString());
}
static void foo() {
    log(null);
}
NullAway will find out that we&rsquo;re passing null and we&rsquo;ll get appropriate error message:"><meta name=author content="Piotr Wittchen"><link rel=canonical href=https://wittchen.io/notes/integrating-nullaway-with-an-android-project/><link crossorigin=anonymous href=/assets/css/stylesheet.c80af583edbf6d005480808633396d1a9b0d58ca46d1324669dcdadb75be4dd5.css integrity="sha256-yAr1g+2/bQBUgICGMzltGpsNWMpG0TJGadza23W+TdU=" rel="preload stylesheet" as=style><link rel=icon href=https://wittchen.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wittchen.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wittchen.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wittchen.io/apple-touch-icon.png><link rel=mask-icon href=https://wittchen.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://wittchen.io/notes/integrating-nullaway-with-an-android-project/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://wittchen.io/notes/integrating-nullaway-with-an-android-project/"><meta property="og:site_name" content="Piotr Wittchen"><meta property="og:title" content="Integrating ErrorProne and NullAway with an Android project"><meta property="og:description" content="Recently, with the remote help of guys from Uber in California, I integrated NullAway and ErrorProne with the one of my open-source Android projects.
What is NullAway? Basically, it’s a tool to help eliminate NullPointerExceptions (NPEs) in your Java code. It detects situations where NPE could occur at the compile time. Let’s have a look at the following code:
static void log(Object x) { System.out.println(x.toString()); } static void foo() { log(null); } NullAway will find out that we’re passing null and we’ll get appropriate error message:"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="notes"><meta property="article:published_time" content="2017-09-15T18:39:00+00:00"><meta property="article:modified_time" content="2017-09-15T18:39:00+00:00"><meta property="article:tag" content="Java"><meta property="article:tag" content="Android"><meta name=twitter:card content="summary"><meta name=twitter:title content="Integrating ErrorProne and NullAway with an Android project"><meta name=twitter:description content="Recently, with the remote help of guys from Uber in California, I integrated NullAway and ErrorProne with the one of my open-source Android projects.
What is NullAway?
Basically, it&rsquo;s a tool to help eliminate NullPointerExceptions (NPEs) in your Java code. It detects situations where NPE could occur at the compile time. Let&rsquo;s have a look at the following code:
static void log(Object x) {
    System.out.println(x.toString());
}
static void foo() {
    log(null);
}
NullAway will find out that we&rsquo;re passing null and we&rsquo;ll get appropriate error message:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Notes","item":"https://wittchen.io/notes/"},{"@type":"ListItem","position":2,"name":"Integrating ErrorProne and NullAway with an Android project","item":"https://wittchen.io/notes/integrating-nullaway-with-an-android-project/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Integrating ErrorProne and NullAway with an Android project","name":"Integrating ErrorProne and NullAway with an Android project","description":"Recently, with the remote help of guys from Uber in California, I integrated NullAway and ErrorProne with the one of my open-source Android projects.\nWhat is NullAway? Basically, it\u0026rsquo;s a tool to help eliminate NullPointerExceptions (NPEs) in your Java code. It detects situations where NPE could occur at the compile time. Let\u0026rsquo;s have a look at the following code:\nstatic void log(Object x) { System.out.println(x.toString()); } static void foo() { log(null); } NullAway will find out that we\u0026rsquo;re passing null and we\u0026rsquo;ll get appropriate error message:\n","keywords":["java","android"],"articleBody":"Recently, with the remote help of guys from Uber in California, I integrated NullAway and ErrorProne with the one of my open-source Android projects.\nWhat is NullAway? Basically, it’s a tool to help eliminate NullPointerExceptions (NPEs) in your Java code. It detects situations where NPE could occur at the compile time. Let’s have a look at the following code:\nstatic void log(Object x) { System.out.println(x.toString()); } static void foo() { log(null); } NullAway will find out that we’re passing null and we’ll get appropriate error message:\nwarning: [NullAway] passing @Nullable parameter 'null' where @NonNull is required log(null); ^ It’s good to have checks like that because they eliminate possible bugs in advance and follows Clean Code principles.\nA few words about ErrorProne NullAway is built as a plugin to ErrorProne and can run on every single build of our code. Moreover, ErrorProne can perform other checks on our code, which can find out commonly people mistakes. E.g. it can detect a situation, where programmer forgot to add @Test annotation in the unit test method in a test suite and other things. It has built-in bug patterns, which are used during code analysis.\nIntegration with the Android project I’ve integrated ErrorProne and NullAway with ReactiveNetwork Android library. First, in the main build.gradle file, I’ve added the following lines:\next.deps = [ ... nullaway : 'com.uber.nullaway:nullaway:0.1.2', errorprone : 'com.google.errorprone:error_prone_core:2.1.1', ... ] buildscript { repositories { jcenter() maven { url 'https://plugins.gradle.org/m2/' } } dependencies { ... classpath 'net.ltgt.gradle:gradle-errorprone-plugin:0.0.11' classpath 'net.ltgt.gradle:gradle-apt-plugin:0.11' // NOTE: Do not place your application dependencies here; they belong // in the individual module build.gradle files } } Next, in the library/build.gradle file, I’ve added appropriate plugins in the top:\napply plugin: 'net.ltgt.errorprone' apply plugin: 'net.ltgt.apt' Afterwards, I could add dependencies:\ndependencies { ... annotationProcessor deps.nullaway errorprone deps.errorprone } The last thing to do, is the task responsible for running analysis during project compilation:\ntasks.withType(JavaCompile) { if (!name.toLowerCase().contains(\"test\")) { options.compilerArgs += [\"-Xep:NullAway:ERROR\", \"-XepOpt:NullAway:AnnotatedPackages=com.github.pwittchen.reactivenetwork\"] } } That’s it! Now, I could run analysis by typing:\n./gradlew check and fix the issues. I think, a quite similar approach and configuration could be applied to a regular, pure Java project built with Gradle. If you’re interested in the complete configurations, check it out in my project at: https://github.com/pwittchen/ReactiveNetwork. You can also view Pull Request #226 made by @msridhar (kudos for him!).\n","wordCount":"387","inLanguage":"en","datePublished":"2017-09-15T18:39:00Z","dateModified":"2017-09-15T18:39:00Z","author":{"@type":"Person","name":"Piotr Wittchen"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wittchen.io/notes/integrating-nullaway-with-an-android-project/"},"publisher":{"@type":"Organization","name":"Piotr Wittchen","logo":{"@type":"ImageObject","url":"https://wittchen.io/favicon.ico"}}}</script><script defer data-website-id=dfid_D4sN47CVgrrCRR7KCciN3 data-domain=wittchen.io src=https://datafa.st/js/script.js></script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wittchen.io/ accesskey=h title="Piotr Wittchen (Alt + H)">Piotr Wittchen</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wittchen.io/notes/ title=notes><span>notes</span></a></li><li><a href=https://wittchen.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://wittchen.io/talks/ title=talks><span>talks</span></a></li><li><a href=https://wittchen.io/projects/ title=projects><span>projects</span></a></li><li><a href=https://wittchen.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://wittchen.io/contact/ title=contact><span>contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wittchen.io/>Home</a>&nbsp;»&nbsp;<a href=https://wittchen.io/notes/>Notes</a></div><h1 class="post-title entry-hint-parent">Integrating ErrorProne and NullAway with an Android project</h1><div class=post-meta><span title='2017-09-15 18:39:00 +0000 UTC'>September 15, 2017</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;387 words&nbsp;·&nbsp;Piotr Wittchen&nbsp;|&nbsp;<a href=https://github.com/pwittchen/wittchen.io/blob/master/content/notes/integrating-nullaway-with-an-android-project.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>Recently, with the <a href=https://github.com/pwittchen/ReactiveNetwork/pull/226>remote help of guys from Uber in California</a>, I integrated <a href=https://github.com/uber/NullAway/>NullAway</a> and <a href=https://github.com/google/error-prone>ErrorProne</a> with the <a href=https://github.com/pwittchen/ReactiveNetwork>one of my open-source Android projects</a>.</p><h2 id=what-is-nullaway>What is NullAway?<a hidden class=anchor aria-hidden=true href=#what-is-nullaway>#</a></h2><p>Basically, it&rsquo;s <em>a tool to help eliminate NullPointerExceptions (NPEs) in your Java code</em>. It detects situations where NPE could occur at the compile time. Let&rsquo;s have a look at the following code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>log</span><span class=p>(</span><span class=n>Object</span><span class=w> </span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>x</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>foo</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>log</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>NullAway will find out that we&rsquo;re passing <code>null</code> and we&rsquo;ll get appropriate error message:</p><pre tabindex=0><code>warning: [NullAway] passing @Nullable parameter &#39;null&#39; where @NonNull is required
    log(null);
        ^
</code></pre><p>It&rsquo;s good to have checks like that because they eliminate possible bugs in advance and follows Clean Code principles.</p><h2 id=a-few-words-about-errorprone>A few words about ErrorProne<a hidden class=anchor aria-hidden=true href=#a-few-words-about-errorprone>#</a></h2><p>NullAway is built as a plugin to <a href=http://errorprone.info/>ErrorProne</a> and can run on every single build of our code. Moreover, ErrorProne can perform other checks on our code, which can find out commonly people mistakes. E.g. it can detect a situation, where programmer forgot to add <code>@Test</code> annotation in the unit test method in a test suite and other things. It has built-in <a href=http://errorprone.info/bugpatterns>bug patterns</a>, which are used during code analysis.</p><h2 id=integration-with-the-android-project>Integration with the Android project<a hidden class=anchor aria-hidden=true href=#integration-with-the-android-project>#</a></h2><p>I&rsquo;ve integrated ErrorProne and NullAway with <a href=https://github.com/pwittchen/ReactiveNetwork>ReactiveNetwork</a> Android library. First, in the main <code>build.gradle</code> file, I&rsquo;ve added the following lines:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gradle data-lang=gradle><span class=line><span class=cl><span class=n>ext</span><span class=o>.</span><span class=na>deps</span> <span class=o>=</span>  <span class=o>[</span>
</span></span><span class=line><span class=cl>            <span class=o>...</span>
</span></span><span class=line><span class=cl>            <span class=n>nullaway</span>          <span class=o>:</span> <span class=s1>&#39;com.uber.nullaway:nullaway:0.1.2&#39;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=n>errorprone</span>        <span class=o>:</span> <span class=s1>&#39;com.google.errorprone:error_prone_core:2.1.1&#39;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=o>...</span>
</span></span><span class=line><span class=cl>            <span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>buildscript</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>repositories</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>jcenter</span><span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=n>maven</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>url</span> <span class=s1>&#39;https://plugins.gradle.org/m2/&#39;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=n>dependencies</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=n>classpath</span> <span class=s1>&#39;net.ltgt.gradle:gradle-errorprone-plugin:0.0.11&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>classpath</span> <span class=s1>&#39;net.ltgt.gradle:gradle-apt-plugin:0.11&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// NOTE: Do not place your application dependencies here; they belong
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// in the individual module build.gradle files
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Next, in the <code>library/build.gradle</code> file, I&rsquo;ve added appropriate plugins in the top:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gradle data-lang=gradle><span class=line><span class=cl><span class=n>apply</span> <span class=nl>plugin:</span> <span class=s1>&#39;net.ltgt.errorprone&#39;</span>
</span></span><span class=line><span class=cl><span class=n>apply</span> <span class=nl>plugin:</span> <span class=s1>&#39;net.ltgt.apt&#39;</span>
</span></span></code></pre></div><p>Afterwards, I could add dependencies:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gradle data-lang=gradle><span class=line><span class=cl><span class=n>dependencies</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>annotationProcessor</span> <span class=n>deps</span><span class=o>.</span><span class=na>nullaway</span>
</span></span><span class=line><span class=cl>  <span class=n>errorprone</span> <span class=n>deps</span><span class=o>.</span><span class=na>errorprone</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>The last thing to do, is the task responsible for running analysis during project compilation:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gradle data-lang=gradle><span class=line><span class=cl><span class=n>tasks</span><span class=o>.</span><span class=na>withType</span><span class=o>(</span><span class=n>JavaCompile</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>(!</span><span class=n>name</span><span class=o>.</span><span class=na>toLowerCase</span><span class=o>().</span><span class=na>contains</span><span class=o>(</span><span class=s2>&#34;test&#34;</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>options</span><span class=o>.</span><span class=na>compilerArgs</span> <span class=o>+=</span> <span class=o>[</span><span class=s2>&#34;-Xep:NullAway:ERROR&#34;</span><span class=o>,</span> <span class=s2>&#34;-XepOpt:NullAway:AnnotatedPackages=com.github.pwittchen.reactivenetwork&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>That&rsquo;s it! Now, I could run analysis by typing:</p><pre tabindex=0><code>./gradlew check
</code></pre><p>and fix the issues. I think, a quite similar approach and configuration could be applied to a regular, pure Java project built with Gradle. If you&rsquo;re interested in the complete configurations, check it out in my project at: <a href=https://github.com/pwittchen/ReactiveNetwork>https://github.com/pwittchen/ReactiveNetwork</a>. You can also view <a href=https://github.com/pwittchen/ReactiveNetwork/pull/226>Pull Request #226</a> made by <a href=https://github.com/msridhar>@msridhar</a> (kudos for him!).</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wittchen.io/tags/java/>Java</a></li><li><a href=https://wittchen.io/tags/android/>Android</a></li></ul><nav class=paginav><a class=prev href=https://wittchen.io/notes/jdd-2017-juc-flow-presentation-summary/><span class=title>« Prev</span><br><span>JDD 2017 - Get ready for java.util.concurrent.Flow! - summary</span>
</a><a class=next href=https://wittchen.io/notes/building-sap-hybris-commerce-suite-via-gradle/><span class=title>Next »</span><br><span>Building and running SAP Hybris Commerce Platform via Gradle</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://wittchen.io/>Piotr Wittchen</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>