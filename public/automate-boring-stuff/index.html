<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Automate boring stuff · Piotr Wittchen</title><meta name="description" content="Automate boring stuff - Piotr Wittchen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400"><link rel="search" type="application/opensearchdescription+xml" href="http://wittchen.io/atom.xml" title="Piotr Wittchen"><meta name="generator" content="Hexo 4.0.0"></head><body><div class="wrap"><header><a href="/" class="logo-link"><div>Piotr Wittchen</div></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/archives" target="_self" class="nav-list-link">WRITING</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/code" target="_self" class="nav-list-link">CODE</a></li><li class="nav-list-item"><a href="/projects" target="_self" class="nav-list-link">PROJECTS</a></li><li class="nav-list-item"><a href="/talks" target="_self" class="nav-list-link">TALKS</a></li><li class="nav-list-item"><a href="/contact" target="_self" class="nav-list-link">CONTACT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Automate boring stuff</h1><div class="post-info">Jan 1, 2017</div><div class="post-content"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In my current company all the people who perform creative work (mostly programmers) need to prepare so-called PKUP report. PKUP stands for <em>Podwyższone Koszty Uzyskania Przychodu</em> in the Polish language. It’s legal regulation in Poland, which allows paying a lower income tax due to the particular type of work. For the regular employee, it means that he or she will simply get a bit higher salary per month.</p>
<h2 id="How-the-report-looks-in-practice"><a href="#How-the-report-looks-in-practice" class="headerlink" title="How the report looks in practice?"></a>How the report looks in practice?</h2><p>As a programmer, I simply create software as a source code. Added, removed and modified lines of code in the existing codebase are treated as my creative work. Luckily, we use Git so I can generate <code>*.diff</code> files from the Git repositories I’m contributing to. Besides that, I need to prepare document as a <code>*.docx</code> file with a short description of my work. My tasks look different every month, but <strong>report actually looks almost the same every month</strong>. Preparing this report is boring and repeatable stuff.</p>
<h2 id="Let’s-automate-it"><a href="#Let’s-automate-it" class="headerlink" title="Let’s automate it!"></a>Let’s automate it!</h2><h3 id="Generating-diff-files-from-Git-repos"><a href="#Generating-diff-files-from-Git-repos" class="headerlink" title="Generating *.diff files from Git repos"></a>Generating <code>*.diff</code> files from Git repos</h3><p>I simply created a <a href="https://github.com/pwittchen/pkup/blob/master/pkup" target="_blank" rel="noopener">shell script</a>, which goes through predefined project directories and saves <code>*.diff</code> files with names the same as project directory with changes performed by me from the 20th day of the last month until now.</p>
<h3 id="Generating-docx-document"><a href="#Generating-docx-document" class="headerlink" title="Generating *.docx document"></a>Generating <code>*.docx</code> document</h3><p>Next, I created a <a href="https://github.com/pwittchen/pkup/blob/master/pkup_doc.py" target="_blank" rel="noopener">python script</a>, which is parametrized and used by shell script. It uses <a href="https://python-docx.readthedocs.io/en/latest/" target="_blank" rel="noopener">python-docx</a> library for generating <code>*.docx</code> report. I’ve chosen such option, because it’s one of the simplest solutions I’ve found and it’s lightweight. Moreover it can be easily used on Unix systems and integrated with shell scripts.</p>
<h2 id="Personalization"><a href="#Personalization" class="headerlink" title="Personalization"></a>Personalization</h2><p>I wanted to make a script available and usable for everyone, so I created <a href="https://github.com/pwittchen/pkup/blob/master/.pkup.conf" target="_blank" rel="noopener">.pkup.conf</a> file, which is responsible for personalization and configuration of the script. I think, it looks pretty straightforward.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yDEV_PROJECTS_DIR=$yHYBRIS_SRC</span><br><span class="line">yDEV_PROJECTS_LIST=(backoffice platform-backoffice cockpitng backofficesearch pcm pcmbackoffice cockpit cockpit-core)</span><br><span class="line">yDEV_REPORT_DIR=~/Documents/hybris/pkup/raporty/doc/</span><br><span class="line">yDEV_NAME=&quot;Your name&quot;</span><br><span class="line">yDEV_SURNAME=&quot;Your surname&quot;</span><br><span class="line">yDEV_ROLE=&quot;Software Developer&quot;</span><br><span class="line">yDEV_DEPARTMENT=&quot;P&amp;I&quot;</span><br><span class="line">yDEV_MANAGER=&quot;Your manager name and surname&quot;</span><br></pre></td></tr></table></figure>

<h2 id="Installation-and-uninstallation"><a href="#Installation-and-uninstallation" class="headerlink" title="Installation and uninstallation"></a>Installation and uninstallation</h2><p>I also created <a href="https://github.com/pwittchen/pkup/blob/master/install.sh" target="_blank" rel="noopener">installation script</a>, which allows to start using the scripts faster. Installation script install dependencies for python script, copies shell script and python script into <code>/usr/local/bin/</code> directory and <code>.pkup.conf</code> file into home directory. Configuration file needs to be adjusted by the user manually after installtion. Of course, there’s another script, which can be used for <a href="https://github.com/pwittchen/pkup/blob/master/uninstall.sh" target="_blank" rel="noopener">uninstallation</a>.</p>
<h2 id="Tests"><a href="#Tests" class="headerlink" title="Tests"></a>Tests</h2><p>There are python tests for this solution in <a href="https://github.com/pwittchen/pkup/blob/master/pkup_doc_test.py" target="_blank" rel="noopener">pkup_doc_test.py</a> file, but they’re quite poor right now due to the limited amount of time. They can be a subject of improvements in the future. Note that such scripting solutions rarely have tests because they’re small and created ad-hoc. Nevertheless, I wanted to follow the philosophy from <a href="/2016/11/30/lifting-quality-of-a-shell-script/">my last blog article</a> and create tests for any kind of software I make.</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>I’ve spent some time for preparing this stuff, but it was fun and I think it should save me and hopefully my co-workers some amount of time during creating reports every month. In the future, it can be improved by automatic generation of report messages and sending data to the server. </p>
<p>To sum up, <strong>preparing reports manually is boring</strong>. <strong>Generating reports automatically is exciting</strong>! </p>
<p>Complete solution described in this article with documentation is available on GitHub:<br><a href="https://github.com/pwittchen/pkup" target="_blank" rel="noopener"><strong>https://github.com/pwittchen/pkup</strong></a>.</p>
</div></article></div></main><footer><div class="paginator"><a href="/one-year-of-using-macbook-pro-as-a-software-developer/" class="prev">PREV</a><a href="/lifting-quality-of-a-shell-script/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'wittchenio';
var disqus_identifier = 'automate-boring-stuff/';
var disqus_title = 'Automate boring stuff';
var disqus_url = 'http://wittchen.io/automate-boring-stuff/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//undefined.disqus.com/count.js" async></script><div class="copyright"><p>© 2013 - 2019 <a href="http://wittchen.io">Piotr Wittchen</a></p><p><a href="https://github.com/pwittchen/wittchen.io" target="_blank" rel="noopener">source</a> / <a href="/feed.xml">rss</a> / <a href="/archives">archives</a> / <a href="/tags">tags</a> / <a href="https://github.com/pwittchen/wittchen.io#rest" target="_blank" rel="noopener">api</a> / <a href="/gh">github</a> / <a href="/so">stackoverflow</a> / <a href="/in">linkedin</a> / <a href="mailto:piotr@wittchen.io">email</a></p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-2194664-7",'auto');ga('send','pageview');</script></body></html>