<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to read contacts in Android device using ContentResolver? | Piotr Wittchen</title><meta name=keywords content="android,java"><meta name=description content="With Content Providers we can access data stored by Android system applications. Popular example of using Content Provider is retrieving contact list from the smartphone. We can also access Calendar or create our own Content Provider. More information about that can be found in documentation of Android. If we want to access Content Provider, we can use Content Resolver in our application&rsquo;s context.
In this example, we will access contact list."><meta name=author content="Piotr Wittchen"><link rel=canonical href=https://wittchen.io/posts/how-to-read-contacts-in-android-device-using-contentresolver/><link crossorigin=anonymous href=/assets/css/stylesheet.cdcf872f971c70fddc7fd480e8457cd308ed0cf287b498bcdc6183fc6d147858.css integrity="sha256-zc+HL5cccP3cf9SA6EV80wjtDPKHtJi83GGD/G0UeFg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wittchen.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wittchen.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wittchen.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wittchen.io/apple-touch-icon.png><link rel=mask-icon href=https://wittchen.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="How to read contacts in Android device using ContentResolver?"><meta property="og:description" content="With Content Providers we can access data stored by Android system applications. Popular example of using Content Provider is retrieving contact list from the smartphone. We can also access Calendar or create our own Content Provider. More information about that can be found in documentation of Android. If we want to access Content Provider, we can use Content Resolver in our application&rsquo;s context.
In this example, we will access contact list."><meta property="og:type" content="article"><meta property="og:url" content="https://wittchen.io/posts/how-to-read-contacts-in-android-device-using-contentresolver/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-03-02T22:23:00+00:00"><meta property="article:modified_time" content="2014-03-02T22:23:00+00:00"><meta property="og:site_name" content="Piotr Wittchen"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to read contacts in Android device using ContentResolver?"><meta name=twitter:description content="With Content Providers we can access data stored by Android system applications. Popular example of using Content Provider is retrieving contact list from the smartphone. We can also access Calendar or create our own Content Provider. More information about that can be found in documentation of Android. If we want to access Content Provider, we can use Content Resolver in our application&rsquo;s context.
In this example, we will access contact list."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wittchen.io/posts/"},{"@type":"ListItem","position":2,"name":"How to read contacts in Android device using ContentResolver?","item":"https://wittchen.io/posts/how-to-read-contacts-in-android-device-using-contentresolver/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to read contacts in Android device using ContentResolver?","name":"How to read contacts in Android device using ContentResolver?","description":"With Content Providers we can access data stored by Android system applications. Popular example of using Content Provider is retrieving contact list from the smartphone. We can also access Calendar or create our own Content Provider. More information about that can be found in documentation of Android. If we want to access Content Provider, we can use Content Resolver in our application\u0026rsquo;s context.\nIn this example, we will access contact list.","keywords":["android","java"],"articleBody":"With Content Providers we can access data stored by Android system applications. Popular example of using Content Provider is retrieving contact list from the smartphone. We can also access Calendar or create our own Content Provider. More information about that can be found in documentation of Android. If we want to access Content Provider, we can use Content Resolver in our application’s context.\nIn this example, we will access contact list. First of all, it’s good to create Contact entity class, which will be model of our data.\npublic class Contact { public int id; public String name; public String phone; public String email; public String uriString; } We can access application’s context through GenericApplication class extending Application class.\npublic class GenericApplication extends Application { private static Application instance; @Override public void onCreate() { super.onCreate(); instance = this; } public static Context getContext() { return instance.getApplicationContext(); } } We can use static application’s context in many situations. Nevertheless, we should avoid this practice when we work with UI and Views, because we may have problems with styles, look \u0026 feel of the application and other issues.\nNow, we can create ContactsProvider class (we can call it as we want).\npublic class ContactsProvider { private Uri QUERY_URI = ContactsContract.Contacts.CONTENT_URI; private String CONTACT_ID = ContactsContract.Contacts._ID; private String DISPLAY_NAME = ContactsContract.Contacts.DISPLAY_NAME; private Uri EMAIL_CONTENT_URI = ContactsContract.CommonDataKinds.Email.CONTENT_URI; private String EMAIL_CONTACT_ID = ContactsContract.CommonDataKinds.Email.CONTACT_ID; private String EMAIL_DATA = ContactsContract.CommonDataKinds.Email.DATA; private String HAS_PHONE_NUMBER = ContactsContract.Contacts.HAS_PHONE_NUMBER; private String PHONE_NUMBER = ContactsContract.CommonDataKinds.Phone.NUMBER; private Uri PHONE_CONTENT_URI = ContactsContract.CommonDataKinds.Phone.CONTENT_URI; private String PHONE_CONTACT_ID = ContactsContract.CommonDataKinds.Phone.CONTACT_ID; private String STARRED_CONTACT = ContactsContract.Contacts.STARRED; private ContentResolver contentResolver; public ContactsProvider() { contentResolver = GenericApplication.getContext().getContentResolver(); } public ListContact getContacts() { ListContact contactList = new ArrayListContact(); String[] projection = new String[]{CONTACT_ID, DISPLAY_NAME, HAS_PHONE_NUMBER, STARRED_CONTACT}; String selection = null; Cursor cursor = contentResolver.query(QUERY_URI, projection, selection, null, null); while (cursor.moveToNext()) { Contact contact = getContact(cursor); contactList.add(contact); } cursor.close(); return contactList; } private Contact getContact(Cursor cursor) { String contactId = cursor.getString(cursor.getColumnIndex(CONTACT_ID)); String name = (cursor.getString(cursor.getColumnIndex(DISPLAY_NAME))); Uri uri = Uri.withAppendedPath(QUERY_URI, String.valueOf(contactId)); Intent intent = new Intent(Intent.ACTION_VIEW); intent.setData(uri); String intentUriString = intent.toUri(0); Contact contact = new Contact(); contact.id = Integer.valueOf(contactId); contact.name = name; contact.uriString = intentUriString; getPhone(cursor, contactId, contact); getEmail(contactId, contact); return contact; } private void getEmail(String contactId, Contact contact) { Cursor emailCursor = contentResolver.query(EMAIL_CONTENT_URI, null, EMAIL_CONTACT_ID + \" = ?\", new String[]{contactId}, null); while (emailCursor.moveToNext()) { String email = emailCursor.getString(emailCursor.getColumnIndex(EMAIL_DATA)); if (!TextUtils.isEmpty(email)) { contact.email = email; } } emailCursor.close(); } private void getPhone(Cursor cursor, String contactId, Contact contact) { int hasPhoneNumber = Integer.parseInt(cursor.getString(cursor.getColumnIndex(HAS_PHONE_NUMBER))); if (hasPhoneNumber  0) { Cursor phoneCursor = contentResolver.query(PHONE_CONTENT_URI, null, PHONE_CONTACT_ID + \" = ?\", new String[]{contactId}, null); while (phoneCursor.moveToNext()) { String phoneNumber = phoneCursor.getString(phoneCursor.getColumnIndex(PHONE_NUMBER)); contact.phone = phoneNumber; } phoneCursor.close(); } } } We can filter our data, by manipulating selection parameter. E.g. if we want to retrieve only starred contacts, we can change “selection” parameter in the following way:\nString selection = STARRED_CONTACT + \"='1'\"; If we want to retrieve more or less data, we can manipulate “projection” parameter. ContentResolver is just kind of proxy for SQLite databases available in Android applications, which allows us to access this data in a safe way. We can use SQL language in order to select proper data. Check Android documentation for more details.\nWe also need to remember to add proper parameter to our AndroidManifest.xml file.\n android:name=\"android.permission.READ_CONTACTS\" / If we want to use GenericApplication class, we should also add proper attribute to application tag in AndroidManifest.xml file.\n android:name=\"com.pwittchen.example.generics.GenericApplication\" That’s it!\nNow, we can use our class to read contacts very easily. We can even create an adapter and display contacts on the list or do whatever we want to.\n","wordCount":"599","inLanguage":"en","datePublished":"2014-03-02T22:23:00Z","dateModified":"2014-03-02T22:23:00Z","author":{"@type":"Person","name":"Piotr Wittchen"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wittchen.io/posts/how-to-read-contacts-in-android-device-using-contentresolver/"},"publisher":{"@type":"Organization","name":"Piotr Wittchen","logo":{"@type":"ImageObject","url":"https://wittchen.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wittchen.io/ accesskey=h title="Piotr Wittchen (Alt + H)">Piotr Wittchen</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wittchen.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://wittchen.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://wittchen.io/talks/ title=talks><span>talks</span></a></li><li><a href=https://wittchen.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://wittchen.io/contact/ title=contact><span>contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wittchen.io/>Home</a>&nbsp;»&nbsp;<a href=https://wittchen.io/posts/>Posts</a></div><h1 class=post-title>How to read contacts in Android device using ContentResolver?</h1><div class=post-meta><span title="2014-03-02 22:23:00 +0000 UTC">March 2, 2014</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;599 words&nbsp;·&nbsp;Piotr Wittchen&nbsp;|&nbsp;<a href=https://github.com/pwittchen/wittchen.io/blob/master/content/posts/how-to-read-contacts-in-android-device-using-contentresolver.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>With <a href=http://developer.android.com/guide/topics/providers/content-providers.html>Content Providers</a> we can access data stored by Android system applications. Popular example of using Content Provider is retrieving contact list from the smartphone. We can also access Calendar or create our own Content Provider. More information about that can be found in documentation of Android. If we want to access Content Provider, we can use <a href=http://developer.android.com/reference/android/content/ContentResolver.html>Content Resolver</a> in our application&rsquo;s context.</p><p>In this example, we will access contact list. First of all, it’s good to create Contact entity class, which will be model of our data.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Contact</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>phone</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>email</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>uriString</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>We can access application’s context through GenericApplication class extending Application class.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>GenericApplication</span> <span class=kd>extends</span> <span class=n>Application</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Application</span> <span class=n>instance</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onCreate</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>.</span><span class=na>onCreate</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>instance</span> <span class=o>=</span> <span class=k>this</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Context</span> <span class=nf>getContext</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>instance</span><span class=o>.</span><span class=na>getApplicationContext</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>We can use static application’s context in many situations. Nevertheless, we should avoid this practice when we work with UI and Views, because we may have problems with styles, look & feel of the application and other issues.</p><p>Now, we can create ContactsProvider class (we can call it as we want).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ContactsProvider</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Uri</span> <span class=n>QUERY_URI</span> <span class=o>=</span> <span class=n>ContactsContract</span><span class=o>.</span><span class=na>Contacts</span><span class=o>.</span><span class=na>CONTENT_URI</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>CONTACT_ID</span> <span class=o>=</span> <span class=n>ContactsContract</span><span class=o>.</span><span class=na>Contacts</span><span class=o>.</span><span class=na>_ID</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>DISPLAY_NAME</span> <span class=o>=</span> <span class=n>ContactsContract</span><span class=o>.</span><span class=na>Contacts</span><span class=o>.</span><span class=na>DISPLAY_NAME</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Uri</span> <span class=n>EMAIL_CONTENT_URI</span> <span class=o>=</span> <span class=n>ContactsContract</span><span class=o>.</span><span class=na>CommonDataKinds</span><span class=o>.</span><span class=na>Email</span><span class=o>.</span><span class=na>CONTENT_URI</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>EMAIL_CONTACT_ID</span> <span class=o>=</span> <span class=n>ContactsContract</span><span class=o>.</span><span class=na>CommonDataKinds</span><span class=o>.</span><span class=na>Email</span><span class=o>.</span><span class=na>CONTACT_ID</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>EMAIL_DATA</span> <span class=o>=</span> <span class=n>ContactsContract</span><span class=o>.</span><span class=na>CommonDataKinds</span><span class=o>.</span><span class=na>Email</span><span class=o>.</span><span class=na>DATA</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>HAS_PHONE_NUMBER</span> <span class=o>=</span> <span class=n>ContactsContract</span><span class=o>.</span><span class=na>Contacts</span><span class=o>.</span><span class=na>HAS_PHONE_NUMBER</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>PHONE_NUMBER</span> <span class=o>=</span> <span class=n>ContactsContract</span><span class=o>.</span><span class=na>CommonDataKinds</span><span class=o>.</span><span class=na>Phone</span><span class=o>.</span><span class=na>NUMBER</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Uri</span> <span class=n>PHONE_CONTENT_URI</span> <span class=o>=</span> <span class=n>ContactsContract</span><span class=o>.</span><span class=na>CommonDataKinds</span><span class=o>.</span><span class=na>Phone</span><span class=o>.</span><span class=na>CONTENT_URI</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>PHONE_CONTACT_ID</span> <span class=o>=</span> <span class=n>ContactsContract</span><span class=o>.</span><span class=na>CommonDataKinds</span><span class=o>.</span><span class=na>Phone</span><span class=o>.</span><span class=na>CONTACT_ID</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>STARRED_CONTACT</span> <span class=o>=</span> <span class=n>ContactsContract</span><span class=o>.</span><span class=na>Contacts</span><span class=o>.</span><span class=na>STARRED</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>ContentResolver</span> <span class=n>contentResolver</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>ContactsProvider</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>contentResolver</span> <span class=o>=</span> <span class=n>GenericApplication</span><span class=o>.</span><span class=na>getContext</span><span class=o>().</span><span class=na>getContentResolver</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>Contact</span><span class=o>&gt;</span> <span class=nf>getContacts</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>List</span><span class=o>&lt;</span><span class=n>Contact</span><span class=o>&gt;</span> <span class=n>contactList</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Contact</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span><span class=o>[]</span> <span class=n>projection</span> <span class=o>=</span> <span class=k>new</span> <span class=n>String</span><span class=o>[]{</span><span class=n>CONTACT_ID</span><span class=o>,</span> <span class=n>DISPLAY_NAME</span><span class=o>,</span> <span class=n>HAS_PHONE_NUMBER</span><span class=o>,</span> <span class=n>STARRED_CONTACT</span><span class=o>};</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>selection</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>Cursor</span> <span class=n>cursor</span> <span class=o>=</span> <span class=n>contentResolver</span><span class=o>.</span><span class=na>query</span><span class=o>(</span><span class=n>QUERY_URI</span><span class=o>,</span> <span class=n>projection</span><span class=o>,</span> <span class=n>selection</span><span class=o>,</span> <span class=kc>null</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=n>cursor</span><span class=o>.</span><span class=na>moveToNext</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Contact</span> <span class=n>contact</span> <span class=o>=</span> <span class=n>getContact</span><span class=o>(</span><span class=n>cursor</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>contactList</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>contact</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>cursor</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>contactList</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Contact</span> <span class=nf>getContact</span><span class=o>(</span><span class=n>Cursor</span> <span class=n>cursor</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>contactId</span> <span class=o>=</span> <span class=n>cursor</span><span class=o>.</span><span class=na>getString</span><span class=o>(</span><span class=n>cursor</span><span class=o>.</span><span class=na>getColumnIndex</span><span class=o>(</span><span class=n>CONTACT_ID</span><span class=o>));</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>name</span> <span class=o>=</span> <span class=o>(</span><span class=n>cursor</span><span class=o>.</span><span class=na>getString</span><span class=o>(</span><span class=n>cursor</span><span class=o>.</span><span class=na>getColumnIndex</span><span class=o>(</span><span class=n>DISPLAY_NAME</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>        <span class=n>Uri</span> <span class=n>uri</span> <span class=o>=</span> <span class=n>Uri</span><span class=o>.</span><span class=na>withAppendedPath</span><span class=o>(</span><span class=n>QUERY_URI</span><span class=o>,</span> <span class=n>String</span><span class=o>.</span><span class=na>valueOf</span><span class=o>(</span><span class=n>contactId</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>Intent</span> <span class=n>intent</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Intent</span><span class=o>(</span><span class=n>Intent</span><span class=o>.</span><span class=na>ACTION_VIEW</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>intent</span><span class=o>.</span><span class=na>setData</span><span class=o>(</span><span class=n>uri</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>intentUriString</span> <span class=o>=</span> <span class=n>intent</span><span class=o>.</span><span class=na>toUri</span><span class=o>(</span><span class=n>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>Contact</span> <span class=n>contact</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Contact</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>contact</span><span class=o>.</span><span class=na>id</span> <span class=o>=</span> <span class=n>Integer</span><span class=o>.</span><span class=na>valueOf</span><span class=o>(</span><span class=n>contactId</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>contact</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>contact</span><span class=o>.</span><span class=na>uriString</span> <span class=o>=</span> <span class=n>intentUriString</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>getPhone</span><span class=o>(</span><span class=n>cursor</span><span class=o>,</span> <span class=n>contactId</span><span class=o>,</span> <span class=n>contact</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>getEmail</span><span class=o>(</span><span class=n>contactId</span><span class=o>,</span> <span class=n>contact</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>contact</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>getEmail</span><span class=o>(</span><span class=n>String</span> <span class=n>contactId</span><span class=o>,</span> <span class=n>Contact</span> <span class=n>contact</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Cursor</span> <span class=n>emailCursor</span> <span class=o>=</span> <span class=n>contentResolver</span><span class=o>.</span><span class=na>query</span><span class=o>(</span><span class=n>EMAIL_CONTENT_URI</span><span class=o>,</span> <span class=kc>null</span><span class=o>,</span> <span class=n>EMAIL_CONTACT_ID</span> <span class=o>+</span> <span class=s>&#34; = ?&#34;</span><span class=o>,</span> <span class=k>new</span> <span class=n>String</span><span class=o>[]{</span><span class=n>contactId</span><span class=o>},</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=n>emailCursor</span><span class=o>.</span><span class=na>moveToNext</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>String</span> <span class=n>email</span> <span class=o>=</span> <span class=n>emailCursor</span><span class=o>.</span><span class=na>getString</span><span class=o>(</span><span class=n>emailCursor</span><span class=o>.</span><span class=na>getColumnIndex</span><span class=o>(</span><span class=n>EMAIL_DATA</span><span class=o>));</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(!</span><span class=n>TextUtils</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>(</span><span class=n>email</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>contact</span><span class=o>.</span><span class=na>email</span> <span class=o>=</span> <span class=n>email</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>emailCursor</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>getPhone</span><span class=o>(</span><span class=n>Cursor</span> <span class=n>cursor</span><span class=o>,</span> <span class=n>String</span> <span class=n>contactId</span><span class=o>,</span> <span class=n>Contact</span> <span class=n>contact</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>hasPhoneNumber</span> <span class=o>=</span> <span class=n>Integer</span><span class=o>.</span><span class=na>parseInt</span><span class=o>(</span><span class=n>cursor</span><span class=o>.</span><span class=na>getString</span><span class=o>(</span><span class=n>cursor</span><span class=o>.</span><span class=na>getColumnIndex</span><span class=o>(</span><span class=n>HAS_PHONE_NUMBER</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>hasPhoneNumber</span> <span class=o>&gt;</span> <span class=n>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Cursor</span> <span class=n>phoneCursor</span> <span class=o>=</span> <span class=n>contentResolver</span><span class=o>.</span><span class=na>query</span><span class=o>(</span><span class=n>PHONE_CONTENT_URI</span><span class=o>,</span> <span class=kc>null</span><span class=o>,</span> <span class=n>PHONE_CONTACT_ID</span> <span class=o>+</span> <span class=s>&#34; = ?&#34;</span><span class=o>,</span> <span class=k>new</span> <span class=n>String</span><span class=o>[]{</span><span class=n>contactId</span><span class=o>},</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=o>(</span><span class=n>phoneCursor</span><span class=o>.</span><span class=na>moveToNext</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>String</span> <span class=n>phoneNumber</span> <span class=o>=</span> <span class=n>phoneCursor</span><span class=o>.</span><span class=na>getString</span><span class=o>(</span><span class=n>phoneCursor</span><span class=o>.</span><span class=na>getColumnIndex</span><span class=o>(</span><span class=n>PHONE_NUMBER</span><span class=o>));</span>
</span></span><span class=line><span class=cl>                <span class=n>contact</span><span class=o>.</span><span class=na>phone</span> <span class=o>=</span> <span class=n>phoneNumber</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=n>phoneCursor</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>We can filter our data, by manipulating selection parameter. E.g. if we want to retrieve only starred contacts, we can change “selection” parameter in the following way:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span> <span class=n>selection</span> <span class=o>=</span> <span class=n>STARRED_CONTACT</span> <span class=o>+</span> <span class=s>&#34;=&#39;1&#39;&#34;</span><span class=o>;</span>
</span></span></code></pre></div><p>If we want to retrieve more or less data, we can manipulate “projection” parameter. ContentResolver is just kind of proxy for SQLite databases available in Android applications, which allows us to access this data in a safe way. We can use SQL language in order to select proper data. Check Android documentation for more details.</p><p>We also need to remember to add proper parameter to our <code>AndroidManifest.xml</code> file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;uses-permission</span> <span class=na>android:name=</span><span class=s>&#34;android.permission.READ_CONTACTS&#34;</span> <span class=nt>/&gt;</span>
</span></span></code></pre></div><p>If we want to use GenericApplication class, we should also add proper attribute to <code>application</code> tag in <code>AndroidManifest.xml</code> file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;application</span> <span class=na>android:name=</span><span class=s>&#34;com.pwittchen.example.generics.GenericApplication&#34;</span><span class=nt>&gt;</span>
</span></span></code></pre></div><p>That&rsquo;s it!</p><p>Now, we can use our class to read contacts very easily. We can even create an <a href=http://developer.android.com/reference/android/widget/Adapter.html>adapter</a> and display contacts on the list or do whatever we want to.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wittchen.io/tags/android/>android</a></li><li><a href=https://wittchen.io/tags/java/>java</a></li></ul><nav class=paginav><a class=prev href=https://wittchen.io/posts/how-to-highlight-and-click-on-listview-item-in-android-programmatically/><span class=title>« Prev</span><br><span>How to highlight and click on ListView item in Android programmatically?</span></a>
<a class=next href=https://wittchen.io/posts/avoiding-outofmemory-error-while-loading-large-bitmaps-in-android-ui/><span class=title>Next »</span><br><span>Avoiding OutOfMemory Error while loading large Bitmaps in Android UI</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://wittchen.io/>Piotr Wittchen</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>