<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Basic code refactoring principles | Piotr Wittchen</title><meta name=keywords content><meta name=description content="Introduction I&rsquo;ve recently read a book about Test Driven Development by Kent Beck. It&rsquo;s really good, presents the importance of the TDD and shows how to make a life of the software developer easier. In the TDD we follow red-green-refactor process in which we create a failing unit test, then we fix it and refactor it to make code-base better. There&rsquo;s no golden rule when to refactor or how to refactor code and each project is different, but there are a few principles we may follow when we want to improve our projects through refactoring."><meta name=author content="Piotr Wittchen"><link rel=canonical href=https://wittchen.io/posts/basic-code-refactoring-principles/><link crossorigin=anonymous href=/assets/css/stylesheet.cdcf872f971c70fddc7fd480e8457cd308ed0cf287b498bcdc6183fc6d147858.css integrity="sha256-zc+HL5cccP3cf9SA6EV80wjtDPKHtJi83GGD/G0UeFg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wittchen.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wittchen.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wittchen.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wittchen.io/apple-touch-icon.png><link rel=mask-icon href=https://wittchen.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Basic code refactoring principles"><meta property="og:description" content="Introduction I&rsquo;ve recently read a book about Test Driven Development by Kent Beck. It&rsquo;s really good, presents the importance of the TDD and shows how to make a life of the software developer easier. In the TDD we follow red-green-refactor process in which we create a failing unit test, then we fix it and refactor it to make code-base better. There&rsquo;s no golden rule when to refactor or how to refactor code and each project is different, but there are a few principles we may follow when we want to improve our projects through refactoring."><meta property="og:type" content="article"><meta property="og:url" content="https://wittchen.io/posts/basic-code-refactoring-principles/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-05-05T23:29:00+00:00"><meta property="article:modified_time" content="2017-05-05T23:29:00+00:00"><meta property="og:site_name" content="Piotr Wittchen"><meta name=twitter:card content="summary"><meta name=twitter:title content="Basic code refactoring principles"><meta name=twitter:description content="Introduction I&rsquo;ve recently read a book about Test Driven Development by Kent Beck. It&rsquo;s really good, presents the importance of the TDD and shows how to make a life of the software developer easier. In the TDD we follow red-green-refactor process in which we create a failing unit test, then we fix it and refactor it to make code-base better. There&rsquo;s no golden rule when to refactor or how to refactor code and each project is different, but there are a few principles we may follow when we want to improve our projects through refactoring."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wittchen.io/posts/"},{"@type":"ListItem","position":2,"name":"Basic code refactoring principles","item":"https://wittchen.io/posts/basic-code-refactoring-principles/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Basic code refactoring principles","name":"Basic code refactoring principles","description":"Introduction I\u0026rsquo;ve recently read a book about Test Driven Development by Kent Beck. It\u0026rsquo;s really good, presents the importance of the TDD and shows how to make a life of the software developer easier. In the TDD we follow red-green-refactor process in which we create a failing unit test, then we fix it and refactor it to make code-base better. There\u0026rsquo;s no golden rule when to refactor or how to refactor code and each project is different, but there are a few principles we may follow when we want to improve our projects through refactoring.","keywords":[],"articleBody":"Introduction I’ve recently read a book about Test Driven Development by Kent Beck. It’s really good, presents the importance of the TDD and shows how to make a life of the software developer easier. In the TDD we follow red-green-refactor process in which we create a failing unit test, then we fix it and refactor it to make code-base better. There’s no golden rule when to refactor or how to refactor code and each project is different, but there are a few principles we may follow when we want to improve our projects through refactoring.\nFinding similarities and duplications One of the common code smells is duplication. We should search for the following patterns:\n Two similar loops » try to merge them into one loop Two similar instructions inside conditional statements » try to unify operations and get rid of the “if” statement Two similar methods » try to unify them and remove one of them Two similar classes » try to unify them and remove one of them and so on…  Perform these operations carefully. If something goes wrong, go one step backward. Sometimes it may be impossible to remove all duplications.\nIsolating changes Before we start performing changes, it’s good to isolate a piece of code. We can move it e.g. to separate method, perform changes and then inline our method. That could help us avoid breaking the whole system.\nData migration If we want to change the meaning of the data, we can temporarily duplicate them, perform changes, update interfaces and then remove original code.\nMethod extraction If a method in our class is too big (according to Clean Code, “too big” is longer than 20 lines), we should find code doing specialized mini-task and extract part of it to a separate method. In IntelliJ IDEA we can use Ctrl+Alt+M shortcut or ⌘+Alt+M on Mac for that.\nMethod inlining Sometimes, we’re extracting too many pieces of code to separate methods, what may decrease code readability. If the code inside the method is really simple, so it could be written in a single line or optionally in two lines, we may think about inlining this method. To do so, we should remove method and place code directly in the place where it’s called. To perform inlining in IntelliJ, we can use Ctrl+Alt+N shortcut or ⌘+Alt+N on Mac.\nInterface extraction When we want to create additional implementations of the operations, which already exists in our code-base, we may extract these operations into the interface. IntelliJ IDEA also has support for that. I’m not sure if there’s a shortcut, but you can use Ctrl+Shit+A shortcut or ⌘+Shift+A on Mac to open window with operation search and then type “extract interface”. It should work.\nMoving method It may happen, that our class or interface is becoming too big or it has methods, which are not directly related to this class. In such case, we may simply move one method or a few methods to another, more appropriate class or create a separate class or interface for them.\nObject-method We may encounter a situation when a specific method has too many parameters. In such case, we may consider creating Object-method. It’s some kind of data class, which contains attributes the same as method parameters. It will help us to pass data in our system in a more readable way. We can also connect this solution with a Builder software design pattern.\nAdding parameter During the time, the business logic of our system is getting bigger and one of our methods need to be extended. In such case, we can add another parameter to it. We may also consider creating another, similar method with just one more parameter. When we’re providing API or framework for other developers, we have to remember about proper “deprecated” annotations.\nMoving parameter from method to the constructor It may happen that we want to move a parameter from the method to a constructor to simplify the logic of the project. In order to that, we can move local variable to a class variable (in IntelliJ IDEA: Ctrl+Alt+V shortcut or ⌘+Alt+V on Mac) and then create constructor with this variable (Alt+Insert or ⌘+N on Mac).\nSummary As we can see, there are a few principles, which we may apply during code refactoring to make our project better. Moreover, most of them are supported by IntelliJ IDEA, which is great IDE. If you’re programming in another language than Java and want to have refactoring tools, you should check JetBrains products. Nevertheless, there’s no golden rule of refactoring. Sometimes it’s better to leave the code as it is. Especially if code-base is huge, the project is in production and there are no unit tests. If you want to know more about principles from this article, read Test Driven Development book by Kent Beck. Probably there are more principles than these described in this article. We should perform refactoring carefully and we need to remember about tests. Everything depends on the concrete project and our situation.\n","wordCount":"834","inLanguage":"en","datePublished":"2017-05-05T23:29:00Z","dateModified":"2017-05-05T23:29:00Z","author":{"@type":"Person","name":"Piotr Wittchen"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wittchen.io/posts/basic-code-refactoring-principles/"},"publisher":{"@type":"Organization","name":"Piotr Wittchen","logo":{"@type":"ImageObject","url":"https://wittchen.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wittchen.io/ accesskey=h title="Piotr Wittchen (Alt + H)">Piotr Wittchen</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wittchen.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://wittchen.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://wittchen.io/talks/ title=talks><span>talks</span></a></li><li><a href=https://wittchen.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://wittchen.io/contact/ title=contact><span>contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wittchen.io/>Home</a>&nbsp;»&nbsp;<a href=https://wittchen.io/posts/>Posts</a></div><h1 class=post-title>Basic code refactoring principles</h1><div class=post-meta><span title="2017-05-05 23:29:00 +0000 UTC">May 5, 2017</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;834 words&nbsp;·&nbsp;Piotr Wittchen&nbsp;|&nbsp;<a href=https://github.com/pwittchen/wittchen.io/blob/master/content/posts/basic-code-refactoring-principles.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>I&rsquo;ve recently read a book about <em>Test Driven Development</em> by Kent Beck. It&rsquo;s really good, presents the importance of the TDD and shows how to make a life of the software developer easier. In the TDD we follow <em>red-green-refactor</em> process in which we create a failing unit test, then we fix it and refactor it to make code-base better. There&rsquo;s no golden rule when to refactor or how to refactor code and each project is different, but there are a few principles we may follow when we want to improve our projects through refactoring.</p><h2 id=finding-similarities-and-duplications>Finding similarities and duplications<a hidden class=anchor aria-hidden=true href=#finding-similarities-and-duplications>#</a></h2><p>One of the common <em>code smells</em> is duplication. We should search for the following patterns:</p><ul><li>Two similar loops » try to merge them into one loop</li><li>Two similar instructions inside conditional statements » try to unify operations and get rid of the &ldquo;if&rdquo; statement</li><li>Two similar methods » try to unify them and remove one of them</li><li>Two similar classes » try to unify them and remove one of them</li><li>and so on&mldr;</li></ul><p>Perform these operations carefully. If something goes wrong, go one step backward. Sometimes it may be impossible to remove all duplications.</p><h2 id=isolating-changes>Isolating changes<a hidden class=anchor aria-hidden=true href=#isolating-changes>#</a></h2><p>Before we start performing changes, it&rsquo;s good to isolate a piece of code. We can move it e.g. to separate method, perform changes and then inline our method. That could help us avoid breaking the whole system.</p><h2 id=data-migration>Data migration<a hidden class=anchor aria-hidden=true href=#data-migration>#</a></h2><p>If we want to change the meaning of the data, we can temporarily duplicate them, perform changes, update interfaces and then remove original code.</p><h2 id=method-extraction>Method extraction<a hidden class=anchor aria-hidden=true href=#method-extraction>#</a></h2><p>If a method in our class is too big (according to <em>Clean Code</em>, &ldquo;too big&rdquo; is longer than 20 lines), we should find code doing specialized mini-task and extract part of it to a separate method. In IntelliJ IDEA we can use <code>Ctrl+Alt+M</code> shortcut or <code>⌘+Alt+M</code> on Mac for that.</p><h2 id=method-inlining>Method inlining<a hidden class=anchor aria-hidden=true href=#method-inlining>#</a></h2><p>Sometimes, we&rsquo;re extracting too many pieces of code to separate methods, what may decrease code readability. If the code inside the method is really simple, so it could be written in a single line or optionally in two lines, we may think about inlining this method. To do so, we should remove method and place code directly in the place where it&rsquo;s called. To perform inlining in IntelliJ, we can use <code>Ctrl+Alt+N</code> shortcut or <code>⌘+Alt+N</code> on Mac.</p><h2 id=interface-extraction>Interface extraction<a hidden class=anchor aria-hidden=true href=#interface-extraction>#</a></h2><p>When we want to create additional implementations of the operations, which already exists in our code-base, we may extract these operations into the interface. IntelliJ IDEA also has support for that. I&rsquo;m not sure if there&rsquo;s a shortcut, but you can use <code>Ctrl+Shit+A</code> shortcut or <code>⌘+Shift+A</code> on Mac to open window with operation search and then type <em>&ldquo;extract interface&rdquo;</em>. It should work.</p><h2 id=moving-method>Moving method<a hidden class=anchor aria-hidden=true href=#moving-method>#</a></h2><p>It may happen, that our class or interface is becoming too big or it has methods, which are not directly related to this class. In such case, we may simply move one method or a few methods to another, more appropriate class or create a separate class or interface for them.</p><h2 id=object-method>Object-method<a hidden class=anchor aria-hidden=true href=#object-method>#</a></h2><p>We may encounter a situation when a specific method has too many parameters. In such case, we may consider creating Object-method. It&rsquo;s some kind of data class, which contains attributes the same as method parameters. It will help us to pass data in our system in a more readable way. We can also connect this solution with a Builder software design pattern.</p><h2 id=adding-parameter>Adding parameter<a hidden class=anchor aria-hidden=true href=#adding-parameter>#</a></h2><p>During the time, the business logic of our system is getting bigger and one of our methods need to be extended. In such case, we can add another parameter to it. We may also consider creating another, similar method with just one more parameter. When we&rsquo;re providing API or framework for other developers, we have to remember about proper &ldquo;deprecated&rdquo; annotations.</p><h2 id=moving-parameter-from-method-to-the-constructor>Moving parameter from method to the constructor<a hidden class=anchor aria-hidden=true href=#moving-parameter-from-method-to-the-constructor>#</a></h2><p>It may happen that we want to move a parameter from the method to a constructor to simplify the logic of the project. In order to that, we can move local variable to a class variable (in IntelliJ IDEA: <code>Ctrl+Alt+V</code> shortcut or <code>⌘+Alt+V</code> on Mac) and then create constructor with this variable (<code>Alt+Insert</code> or <code>⌘+N</code> on Mac).</p><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p>As we can see, there are a few principles, which we may apply during code refactoring to make our project better. Moreover, most of them are supported by IntelliJ IDEA, which is great IDE. If you&rsquo;re programming in another language than Java and want to have refactoring tools, you should check JetBrains products. Nevertheless, there&rsquo;s no golden rule of refactoring. Sometimes it&rsquo;s better to leave the code as it is. Especially if code-base is huge, the project is in production and there are no unit tests. If you want to know more about principles from this article, read <em>Test Driven Development</em> book by Kent Beck. Probably there are more principles than these described in this article. We should perform refactoring carefully and we need to remember about tests. Everything depends on the concrete project and our situation.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://wittchen.io/posts/emitting-different-rxjava-observables-depending-on-the-condition-with-flatmap/><span class=title>« Prev</span><br><span>Emitting different observables conditionally</span></a>
<a class=next href=https://wittchen.io/posts/monitoring-usage-of-oss/><span class=title>Next »</span><br><span>Monitoring usage of open-source projects</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://wittchen.io/>Piotr Wittchen</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>