<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Spotify song in i3 status bar | Piotr Wittchen</title><meta name=keywords content="linux,i3,python"><meta name=description content="While customizing my i3 status bar, I wanted to have currently played Spotify song in it. Some time ago, I created an open source script in Python called spotify-cli-linux and I wanted to use it. When we want to put something custom into the i3 status bar, the easiest way to do it, is to save data into the file and then read the file.
I created the following config inside ~/."><meta name=author content="Piotr Wittchen"><link rel=canonical href=https://wittchen.io/posts/spotify-song-in-i3-status-bar/><link crossorigin=anonymous href=/assets/css/stylesheet.cdcf872f971c70fddc7fd480e8457cd308ed0cf287b498bcdc6183fc6d147858.css integrity="sha256-zc+HL5cccP3cf9SA6EV80wjtDPKHtJi83GGD/G0UeFg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wittchen.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wittchen.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wittchen.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wittchen.io/apple-touch-icon.png><link rel=mask-icon href=https://wittchen.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Spotify song in i3 status bar"><meta property="og:description" content="While customizing my i3 status bar, I wanted to have currently played Spotify song in it. Some time ago, I created an open source script in Python called spotify-cli-linux and I wanted to use it. When we want to put something custom into the i3 status bar, the easiest way to do it, is to save data into the file and then read the file.
I created the following config inside ~/."><meta property="og:type" content="article"><meta property="og:url" content="https://wittchen.io/posts/spotify-song-in-i3-status-bar/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-02-20T11:29:13+00:00"><meta property="article:modified_time" content="2020-02-20T11:29:13+00:00"><meta property="og:site_name" content="Piotr Wittchen"><meta name=twitter:card content="summary"><meta name=twitter:title content="Spotify song in i3 status bar"><meta name=twitter:description content="While customizing my i3 status bar, I wanted to have currently played Spotify song in it. Some time ago, I created an open source script in Python called spotify-cli-linux and I wanted to use it. When we want to put something custom into the i3 status bar, the easiest way to do it, is to save data into the file and then read the file.
I created the following config inside ~/."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wittchen.io/posts/"},{"@type":"ListItem","position":2,"name":"Spotify song in i3 status bar","item":"https://wittchen.io/posts/spotify-song-in-i3-status-bar/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Spotify song in i3 status bar","name":"Spotify song in i3 status bar","description":"While customizing my i3 status bar, I wanted to have currently played Spotify song in it. Some time ago, I created an open source script in Python called spotify-cli-linux and I wanted to use it. When we want to put something custom into the i3 status bar, the easiest way to do it, is to save data into the file and then read the file.\nI created the following config inside ~/.","keywords":["linux","i3","python"],"articleBody":"While customizing my i3 status bar, I wanted to have currently played Spotify song in it. Some time ago, I created an open source script in Python called spotify-cli-linux and I wanted to use it. When we want to put something custom into the i3 status bar, the easiest way to do it, is to save data into the file and then read the file.\nI created the following config inside ~/.config/i3status/config file:\norder += \"read_file spotify\" ... read_file spotify { format = \"♪ %content\" path = \"/var/log/scripts/spotify.log\" } .... Approach #1 - cron job The i3 status bar is refreshed automatically according to the configuration. Now, I just needed the way to save the song into the /var/log/scripts/spotify.log file. My first idea was to create a cron job, which will save the song every given interval.\n*/2 * * * * /usr/bin/spotifycli --statusshort  /var/log/scripts/spotify.log Typical song has 2 minutes or more, so it should work. Unfortunately, my script uses dbus under the hood, which doesn’t have an access to the session of the desktop user. After searching the web for a while, I noticed that passing data from the user session into this script is not a trivial thing and cannot be done quickly. I decided to search for another solution.\nApproach #2 - media buttons I wanted to be able to control spotify via media buttons on my keyboard. On i3 it doesn’t work out of the box, and we need to configure it. To do that, I added the folloiwng key bindings in ~/.config/i3/config file:\nbindsym XF86AudioPlay exec \"spotifycli --playpause\" bindsym XF86AudioNext exec \"spotifycli --next\" bindsym XF86AudioPrev exec \"spotifycli --prev\" It works fine. We can also improve it, to make it work with other players, make it more general, etc., but in my case I use just Spotify for the music and podcasts, so it’s enough for me.\nWe can update this functioanlity to save song whenever we change it or start it:\nbindsym XF86AudioPlay exec \"spotifycli --playpause \u0026\u0026 spotifycli --statusshort  /var/log/scripts/spotify.log\" bindsym XF86AudioNext exec \"spotifycli --next \u0026\u0026 spotifycli --statusshort  /var/log/scripts/spotify.log\" bindsym XF86AudioPrev exec \"spotifycli --prev \u0026\u0026 spotifycli --statusshort  /var/log/scripts/spotify.log\" and this will work, but unfortunately, when song will change automatically on the playlist, status won’t be updated, so this solution is not right.\nApproach #3 (correct) - notifications Spotify desktop application is sending notifications whenever the song changes. On i3, we need to install notification daemon/server, to make it work. On Arch Wiki, we can see list of the popular daemons. I decided to use Dunst because it’s simple, light-weight, open-source, configurable, is actively developed and supported by its maintainers. Once I installed Dunst and started it to enable daemon, I started receiving system notifications (including Spotify).\nI edited Dunst configuration in ~/.config/dust/dunstrc file and added handler for Spotify:\n[spotify] appname = Spotify urgency = normal script = ~/.scripts/spotify_log.sh spotify_log.sh script looks as follows:\n#!/usr/bin/env bash /usr/bin/spotifycli --statusshort  /var/log/scripts/spotify.log Now, whenever I receive a system notification from Spotify that song is changed, currently played song is saved into the file, this file is read by i3 status bar and refreshed in a given interval. Thanks to that, it doesn’t matter if song changes itself or I change it - it’s updated anyway and that’s what I wanted.\n","wordCount":"546","inLanguage":"en","datePublished":"2020-02-20T11:29:13Z","dateModified":"2020-02-20T11:29:13Z","author":{"@type":"Person","name":"Piotr Wittchen"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wittchen.io/posts/spotify-song-in-i3-status-bar/"},"publisher":{"@type":"Organization","name":"Piotr Wittchen","logo":{"@type":"ImageObject","url":"https://wittchen.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wittchen.io/ accesskey=h title="Piotr Wittchen (Alt + H)">Piotr Wittchen</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wittchen.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://wittchen.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://wittchen.io/talks/ title=talks><span>talks</span></a></li><li><a href=https://wittchen.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://wittchen.io/contact/ title=contact><span>contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wittchen.io/>Home</a>&nbsp;»&nbsp;<a href=https://wittchen.io/posts/>Posts</a></div><h1 class=post-title>Spotify song in i3 status bar</h1><div class=post-meta><span title="2020-02-20 11:29:13 +0000 UTC">February 20, 2020</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;546 words&nbsp;·&nbsp;Piotr Wittchen&nbsp;|&nbsp;<a href=https://github.com/pwittchen/wittchen.io/blob/master/content/posts/spotify-song-in-i3-status-bar.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>While customizing my i3 status bar, I wanted to have currently played Spotify song in it. Some time ago, I created an open source script in Python called <a href=https://github.com/pwittchen/spotify-cli-linux>spotify-cli-linux</a> and I wanted to use it. When we want to put something custom into the i3 status bar, the easiest way to do it, is to save data into the file and then read the file.</p><p>I created the following config inside <code>~/.config/i3status/config</code> file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>order</span> <span class=o>+=</span> <span class=s2>&#34;read_file spotify&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>read_file spotify <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>format</span> <span class=o>=</span> <span class=s2>&#34;♪ %content&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nv>path</span> <span class=o>=</span> <span class=s2>&#34;/var/log/scripts/spotify.log&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>....
</span></span></code></pre></div><h2 id=approach-1---cron-job>Approach #1 - cron job<a hidden class=anchor aria-hidden=true href=#approach-1---cron-job>#</a></h2><p>The i3 status bar is refreshed automatically according to the configuration. Now, I just needed the way to save the song into the <code>/var/log/scripts/spotify.log</code> file. My first idea was to create a cron job, which will save the song every given interval.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>*/2 * * * * /usr/bin/spotifycli --statusshort &gt; /var/log/scripts/spotify.log
</span></span></code></pre></div><p>Typical song has 2 minutes or more, so it should work. Unfortunately, my script uses <code>dbus</code> under the hood, which doesn&rsquo;t have an access to the session of the desktop user. After searching the web for a while, I noticed that passing data from the user session into this script is not a trivial thing and cannot be done quickly. I decided to search for another solution.</p><h2 id=approach-2---media-buttons>Approach #2 - media buttons<a hidden class=anchor aria-hidden=true href=#approach-2---media-buttons>#</a></h2><p>I wanted to be able to control spotify via media buttons on my keyboard. On i3 it doesn&rsquo;t work out of the box, and we need to configure it. To do that, I added the folloiwng key bindings in <code>~/.config/i3/config</code> file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bindsym XF86AudioPlay <span class=nb>exec</span> <span class=s2>&#34;spotifycli --playpause&#34;</span>
</span></span><span class=line><span class=cl>bindsym XF86AudioNext <span class=nb>exec</span> <span class=s2>&#34;spotifycli --next&#34;</span>
</span></span><span class=line><span class=cl>bindsym XF86AudioPrev <span class=nb>exec</span> <span class=s2>&#34;spotifycli --prev&#34;</span>
</span></span></code></pre></div><p>It works fine. We can also improve it, to make it work with other players, make it more general, etc., but in my case I use just Spotify for the music and podcasts, so it&rsquo;s enough for me.</p><p>We can update this functioanlity to save song whenever we change it or start it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bindsym XF86AudioPlay <span class=nb>exec</span> <span class=s2>&#34;spotifycli --playpause &amp;&amp; spotifycli --statusshort &gt; /var/log/scripts/spotify.log&#34;</span>
</span></span><span class=line><span class=cl>bindsym XF86AudioNext <span class=nb>exec</span> <span class=s2>&#34;spotifycli --next &amp;&amp; spotifycli --statusshort &gt; /var/log/scripts/spotify.log&#34;</span>
</span></span><span class=line><span class=cl>bindsym XF86AudioPrev <span class=nb>exec</span> <span class=s2>&#34;spotifycli --prev &amp;&amp; spotifycli --statusshort &gt; /var/log/scripts/spotify.log&#34;</span>
</span></span></code></pre></div><p>and this will work, but unfortunately, when song will change automatically on the playlist, status won&rsquo;t be updated, so this solution is not right.</p><h2 id=approach-3-correct---notifications>Approach #3 (correct) - notifications<a hidden class=anchor aria-hidden=true href=#approach-3-correct---notifications>#</a></h2><p>Spotify desktop application is sending notifications whenever the song changes. On i3, we need to install notification daemon/server, to make it work. On <a href=https://wiki.archlinux.org/index.php/Desktop_notifications#Notification_servers>Arch Wiki</a>, we can see list of the popular daemons. I decided to use <a href=https://dunst-project.org/>Dunst</a> because it&rsquo;s simple, light-weight, open-source, configurable, is actively developed and supported by its maintainers. Once I installed Dunst and started it to enable daemon, I started receiving system notifications (including Spotify).</p><p>I edited Dunst configuration in <code>~/.config/dust/dunstrc</code> file and added handler for Spotify:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>spotify<span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=nv>appname</span> <span class=o>=</span> Spotify
</span></span><span class=line><span class=cl>    <span class=nv>urgency</span> <span class=o>=</span> normal
</span></span><span class=line><span class=cl>    <span class=nv>script</span>  <span class=o>=</span> ~/.scripts/spotify_log.sh
</span></span></code></pre></div><p><code>spotify_log.sh</code> script looks as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/usr/bin/env bash
</span></span></span><span class=line><span class=cl><span class=cp></span>/usr/bin/spotifycli --statusshort &gt; /var/log/scripts/spotify.log
</span></span></code></pre></div><p>Now, whenever I receive a system notification from Spotify that song is changed, currently played song is saved into the file, this file is read by i3 status bar and refreshed in a given interval. Thanks to that, it doesn&rsquo;t matter if song changes itself or I change it - it&rsquo;s updated anyway and that&rsquo;s what I wanted.</p><p><img loading=lazy src=/posts/2020/spotify-song-in-i3-status-bar/i3bar_spotify.png alt></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wittchen.io/tags/linux/>linux</a></li><li><a href=https://wittchen.io/tags/i3/>i3</a></li><li><a href=https://wittchen.io/tags/python/>python</a></li></ul><nav class=paginav><a class=prev href=https://wittchen.io/posts/dynamic-wallpaper-for-i3/><span class=title>« Prev</span><br><span>Dynamic wallpaper for i3</span></a>
<a class=next href=https://wittchen.io/posts/i-switched-to-i3wm/><span class=title>Next »</span><br><span>I switched to i3 WM</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://wittchen.io/>Piotr Wittchen</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>