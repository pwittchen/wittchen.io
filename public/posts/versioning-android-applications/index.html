<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Versioning Android applications | Piotr Wittchen</title><meta name=keywords content="android,gradle,git"><meta name=description content="When we work in a team projects, our code constantly changes and being tested. Often some bugs occur in a specific version of application and no longer exists in next version of the project, because one programmer might fixed the bug according to the Boy Scout Rule and this is good. Nevertheless, sometimes we need to write documentation and check in which version bug occurred to be sure, that it was really fixed."><meta name=author content="Piotr Wittchen"><link rel=canonical href=https://wittchen.io/posts/versioning-android-applications/><link crossorigin=anonymous href=/assets/css/stylesheet.cdcf872f971c70fddc7fd480e8457cd308ed0cf287b498bcdc6183fc6d147858.css integrity="sha256-zc+HL5cccP3cf9SA6EV80wjtDPKHtJi83GGD/G0UeFg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wittchen.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wittchen.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wittchen.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wittchen.io/apple-touch-icon.png><link rel=mask-icon href=https://wittchen.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Versioning Android applications"><meta property="og:description" content="When we work in a team projects, our code constantly changes and being tested. Often some bugs occur in a specific version of application and no longer exists in next version of the project, because one programmer might fixed the bug according to the Boy Scout Rule and this is good. Nevertheless, sometimes we need to write documentation and check in which version bug occurred to be sure, that it was really fixed."><meta property="og:type" content="article"><meta property="og:url" content="https://wittchen.io/posts/versioning-android-applications/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-09-13T12:49:00+00:00"><meta property="article:modified_time" content="2014-09-13T12:49:00+00:00"><meta property="og:site_name" content="Piotr Wittchen"><meta name=twitter:card content="summary"><meta name=twitter:title content="Versioning Android applications"><meta name=twitter:description content="When we work in a team projects, our code constantly changes and being tested. Often some bugs occur in a specific version of application and no longer exists in next version of the project, because one programmer might fixed the bug according to the Boy Scout Rule and this is good. Nevertheless, sometimes we need to write documentation and check in which version bug occurred to be sure, that it was really fixed."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wittchen.io/posts/"},{"@type":"ListItem","position":2,"name":"Versioning Android applications","item":"https://wittchen.io/posts/versioning-android-applications/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Versioning Android applications","name":"Versioning Android applications","description":"When we work in a team projects, our code constantly changes and being tested. Often some bugs occur in a specific version of application and no longer exists in next version of the project, because one programmer might fixed the bug according to the Boy Scout Rule and this is good. Nevertheless, sometimes we need to write documentation and check in which version bug occurred to be sure, that it was really fixed.","keywords":["android","gradle","git"],"articleBody":"When we work in a team projects, our code constantly changes and being tested. Often some bugs occur in a specific version of application and no longer exists in next version of the project, because one programmer might fixed the bug according to the Boy Scout Rule and this is good. Nevertheless, sometimes we need to write documentation and check in which version bug occurred to be sure, that it was really fixed. In addition, QA Engineer needs to know, which version of the project he or she should check. That’s why we should introduce versioning system to our project. In Android Manifest we have versionCode and versionName. The versionCode is used for updates on Google Play Store and it has to be integer value. We should increment versionCode before releasing new version of the application for the users. The versionName available in Android Manifest is a string value and we can use it to store information, which we need in a current project. When we use Git as a Version Control System, we can put SHA value of a specific commit into our version name. In addition, we can add date and time of compilation to this variable. After that, our versionName contains very detailed information about current version of our application. Exemplary versionName will look in as follows: f935ea7-20140913144001. We can obtain that with proper configuration of build.gradle file containing buildTime() method and gitSha() method. Please, take a look at creation of versionName in 35th line of the build.gradle file presented below.\nimport java.text.SimpleDateFormat def buildTime() { def df = new SimpleDateFormat(\"yyyyMMddHHmmss\") df.setTimeZone(TimeZone.getTimeZone(\"Europe/Warsaw\")) return df.format(new Date()) } def gitSha() { return 'git rev-parse --short HEAD'.execute().text.trim() } apply plugin: 'android' apply plugin: 'android-test' android { packagingOptions { exclude 'LICENSE.txt' exclude 'META-INF/LICENSE' exclude 'META-INF/LICENSE.txt' exclude 'META-INF/NOTICE' exclude 'META-INF/NOTICE.txt' exclude 'values/attrs.xml' exclude 'values/dimens.xml' exclude 'values/colors.xml' } compileSdkVersion 19 buildToolsVersion \"19.0.3\" defaultConfig { minSdkVersion 14 targetSdkVersion 19 versionCode 1 versionName gitSha() + '-' + buildTime() } compileOptions { sourceCompatibility JavaVersion.VERSION_1_7 targetCompatibility JavaVersion.VERSION_1_7 } } ","wordCount":"332","inLanguage":"en","datePublished":"2014-09-13T12:49:00Z","dateModified":"2014-09-13T12:49:00Z","author":{"@type":"Person","name":"Piotr Wittchen"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wittchen.io/posts/versioning-android-applications/"},"publisher":{"@type":"Organization","name":"Piotr Wittchen","logo":{"@type":"ImageObject","url":"https://wittchen.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wittchen.io/ accesskey=h title="Piotr Wittchen (Alt + H)"><img src=https://wittchen.io/apple-touch-icon.png alt aria-label=logo height=35>Piotr Wittchen</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wittchen.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://wittchen.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://wittchen.io/talks/ title=talks><span>talks</span></a></li><li><a href=https://github.com/pwittchen title=code><span>code</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://wittchen.io/setup/ title=setup><span>setup</span></a></li><li><a href=https://wittchen.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://wittchen.io/contact/ title=contact><span>contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wittchen.io/>Home</a>&nbsp;»&nbsp;<a href=https://wittchen.io/posts/>Posts</a></div><h1 class=post-title>Versioning Android applications</h1><div class=post-meta><span title="2014-09-13 12:49:00 +0000 UTC">September 13, 2014</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;332 words&nbsp;·&nbsp;Piotr Wittchen&nbsp;|&nbsp;<a href=https://github.com/pwittchen/wittchen.io/blob/master/content/posts/versioning-android-applications.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>When we work in a team projects, our code constantly changes and being tested. Often some bugs occur in a specific version of application and no longer exists in next version of the project, because one programmer might fixed the bug according to the <a href=http://programmer.97things.oreilly.com/wiki/index.php/The_Boy_Scout_Rule>Boy Scout Rule</a> and this is good. Nevertheless, sometimes we need to write documentation and check in which version bug occurred to be sure, that it was really fixed. In addition, <a href=http://en.wikipedia.org/wiki/Quality_assurance>QA</a> Engineer needs to know, which version of the project he or she should check. That&rsquo;s why we should introduce versioning system to our project. In Android Manifest we have <code>versionCode</code> and <code>versionName</code>. The <code>versionCode</code> is used for updates on Google Play Store and it has to be integer value. We should increment <code>versionCode</code> before releasing new version of the application for the users. The <code>versionName</code> available in Android Manifest is a string value and we can use it to store information, which we need in a current project. When we use Git as a Version Control System, we can put SHA value of a specific commit into our version name. In addition, we can add date and time of compilation to this variable. After that, our <code>versionName</code> contains very detailed information about current version of our application. Exemplary <code>versionName</code> will look in as follows: <code>f935ea7-20140913144001</code>. We can obtain that with proper configuration of <code>build.gradle</code> file containing <code>buildTime()</code> method and <code>gitSha()</code> method. Please, take a look at creation of <code>versionName</code> in 35th line of the <code>build.gradle</code> file presented below.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gradle data-lang=gradle><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.text.SimpleDateFormat</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>def</span> <span class=nf>buildTime</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>def</span> <span class=n>df</span> <span class=o>=</span> <span class=k>new</span> <span class=n>SimpleDateFormat</span><span class=o>(</span><span class=s2>&#34;yyyyMMddHHmmss&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=n>df</span><span class=o>.</span><span class=na>setTimeZone</span><span class=o>(</span><span class=n>TimeZone</span><span class=o>.</span><span class=na>getTimeZone</span><span class=o>(</span><span class=s2>&#34;Europe/Warsaw&#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>df</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=k>new</span> <span class=n>Date</span><span class=o>())</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>def</span> <span class=nf>gitSha</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;git rev-parse --short HEAD&#39;</span><span class=o>.</span><span class=na>execute</span><span class=o>().</span><span class=na>text</span><span class=o>.</span><span class=na>trim</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>apply</span> <span class=nl>plugin:</span> <span class=s1>&#39;android&#39;</span>
</span></span><span class=line><span class=cl><span class=n>apply</span> <span class=nl>plugin:</span> <span class=s1>&#39;android-test&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>android</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>packagingOptions</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;LICENSE.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/LICENSE&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/LICENSE.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/NOTICE&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/NOTICE.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;values/attrs.xml&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;values/dimens.xml&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;values/colors.xml&#39;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>compileSdkVersion</span> <span class=mi>19</span>
</span></span><span class=line><span class=cl>    <span class=n>buildToolsVersion</span> <span class=s2>&#34;19.0.3&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>defaultConfig</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>minSdkVersion</span> <span class=mi>14</span>
</span></span><span class=line><span class=cl>        <span class=n>targetSdkVersion</span> <span class=mi>19</span>
</span></span><span class=line><span class=cl>        <span class=n>versionCode</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>versionName</span> <span class=nf>gitSha</span><span class=o>()</span> <span class=o>+</span> <span class=s1>&#39;-&#39;</span> <span class=o>+</span> <span class=n>buildTime</span><span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>compileOptions</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>sourceCompatibility</span> <span class=n>JavaVersion</span><span class=o>.</span><span class=na>VERSION_1_7</span>
</span></span><span class=line><span class=cl>        <span class=n>targetCompatibility</span> <span class=n>JavaVersion</span><span class=o>.</span><span class=na>VERSION_1_7</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://wittchen.io/tags/android/>android</a></li><li><a href=https://wittchen.io/tags/gradle/>gradle</a></li><li><a href=https://wittchen.io/tags/git/>git</a></li></ul><nav class=paginav><a class=prev href=https://wittchen.io/posts/micro-location-based-on-wifi-access-points/><span class=title>« Prev</span><br><span>Micro-location based on WiFi Access Points</span></a>
<a class=next href=https://wittchen.io/posts/updating-android-xml-resources-before-compilation-via-gradle/><span class=title>Next »</span><br><span>Updating Android XML resources before compilation via Gradle</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://wittchen.io/>Piotr Wittchen</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>