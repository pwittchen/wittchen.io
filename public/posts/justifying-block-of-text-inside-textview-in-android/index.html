<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Justifying block of text inside TextView in Android | Piotr Wittchen</title><meta name=keywords content="android"><meta name=description content="Justifying text inside TextView in Android is not that simple as we may expect it to be. Unfortunately, Android does not have attribute for TextView, which supports justifying text. We can set alignment to the right or to the left, but we cannot simply justify text with generic attributes. In order to do that, we need to perform a few tricks. First of all, we need to create file named justified_textview."><meta name=author content="Piotr Wittchen"><link rel=canonical href=https://wittchen.io/posts/justifying-block-of-text-inside-textview-in-android/><link crossorigin=anonymous href=/assets/css/stylesheet.cdcf872f971c70fddc7fd480e8457cd308ed0cf287b498bcdc6183fc6d147858.css integrity="sha256-zc+HL5cccP3cf9SA6EV80wjtDPKHtJi83GGD/G0UeFg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wittchen.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wittchen.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wittchen.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wittchen.io/apple-touch-icon.png><link rel=mask-icon href=https://wittchen.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Justifying block of text inside TextView in Android"><meta property="og:description" content="Justifying text inside TextView in Android is not that simple as we may expect it to be. Unfortunately, Android does not have attribute for TextView, which supports justifying text. We can set alignment to the right or to the left, but we cannot simply justify text with generic attributes. In order to do that, we need to perform a few tricks. First of all, we need to create file named justified_textview."><meta property="og:type" content="article"><meta property="og:url" content="https://wittchen.io/posts/justifying-block-of-text-inside-textview-in-android/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2013-08-31T22:14:00+00:00"><meta property="article:modified_time" content="2013-08-31T22:14:00+00:00"><meta property="og:site_name" content="Piotr Wittchen"><meta name=twitter:card content="summary"><meta name=twitter:title content="Justifying block of text inside TextView in Android"><meta name=twitter:description content="Justifying text inside TextView in Android is not that simple as we may expect it to be. Unfortunately, Android does not have attribute for TextView, which supports justifying text. We can set alignment to the right or to the left, but we cannot simply justify text with generic attributes. In order to do that, we need to perform a few tricks. First of all, we need to create file named justified_textview."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wittchen.io/posts/"},{"@type":"ListItem","position":2,"name":"Justifying block of text inside TextView in Android","item":"https://wittchen.io/posts/justifying-block-of-text-inside-textview-in-android/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Justifying block of text inside TextView in Android","name":"Justifying block of text inside TextView in Android","description":"Justifying text inside TextView in Android is not that simple as we may expect it to be. Unfortunately, Android does not have attribute for TextView, which supports justifying text. We can set alignment to the right or to the left, but we cannot simply justify text with generic attributes. In order to do that, we need to perform a few tricks. First of all, we need to create file named justified_textview.","keywords":["android"],"articleBody":"Justifying text inside TextView in Android is not that simple as we may expect it to be. Unfortunately, Android does not have attribute for TextView, which supports justifying text. We can set alignment to the right or to the left, but we cannot simply justify text with generic attributes. In order to do that, we need to perform a few tricks. First of all, we need to create file named justified_textview.css and we need to put it into the assets/ directory of our project. We will use it later in our custom view. Source code of this CSS stylesheet is presented below:\nbody { font-size: 1.0em; color: rgb(0,0,0); text-align: justify; /* background: rgba(217, 217, 217, 1.0); you can set your background here, it's kind of fix for older versions of Android OS */ } @media screen and (-webkit-device-pixel-ratio: 1.5) { /* CSS for high-density screens */ body { font-size: 1.05em; } } @media screen and (-webkit-device-pixel-ratio: 2.0) { /* CSS for extra high-density screens */ body { font-size: 1.1em; } } Next, we need to create class for customized view extending WebView. Let’s call it JustifiedTextView.\npackage com.github.sample.view; import android.content.Context; import android.content.res.TypedArray; import android.graphics.Color; import android.os.Build; import android.text.TextUtils; import android.util.AttributeSet; import android.util.TypedValue; import android.view.View; import android.webkit.WebView; import com.github.sample.R; public class JustifiedTextView extends WebView { private String text; public JustifiedTextView(final Context context) { this(context, null, 0); } public JustifiedTextView(final Context context, final AttributeSet attrs) { this(context, attrs, 0); } public JustifiedTextView(final Context context, final AttributeSet attrs, final int defStyle) { super(context, attrs, defStyle); if (attrs != null) { final TypedValue typedValue = new TypedValue(); final TypedArray typedArray = context.obtainStyledAttributes(attrs, R.styleable.JustifiedTextView, defStyle, 0); if (typedArray != null) { typedArray.getValue(R.styleable.JustifiedTextView_text, typedValue); if (typedValue.resourceId  0 \u0026\u0026 TextUtils.isEmpty(text)) { text = context.getString(typedValue.resourceId); text.replace(\"\\n\", \"\n\"); loadDataWithBaseURL(\"file:///android_asset/\", \"\" + \"\" + \"\" + text + \"\", \"text/html\", \"UTF8\", null); } setTransparentBackground(); } } } public void setTransparentBackground() { if (Build.VERSION.SDK_INT = 11) { try { setLayerType(View.LAYER_TYPE_SOFTWARE, null); } catch (final NoSuchMethodError e) { Log.d(\"could not set layer\"); } setBackgroundColor(Color.TRANSPARENT); setBackgroundDrawable(null); setBackgroundResource(0); } } public String getText() { return text; } public void setText(String currentText) { this.text = currentText; text.replace(\"\\n\", \"\n\"); loadDataWithBaseURL(\"file:///android_asset/\", \"\" + \"\" + \"\" + text + \"\", \"text/html\", \"UTF8\", null); setTransparentBackground(); } } After that, we need to update res/values/attrs.xml file and put inside the following declaration:\n name=\"JustifiedTextView\"  name=\"text\" format=\"reference\" /  Now, we are ready to use our custom JustifiedTextView. In order to do that, we need to create layout containing JustifiedTextView as follows:\n android:id=\"@+id/tv_information\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" / Next, we can access JustifiedTextView in our activity:\n// ...  private JustifiedTextView tvInformation; public void onCreate() { tvInformation = (JustifiedTextView) findViewById(R.id.tv_information); tVinformation.setText(\"sample text\"); } // ... We can also set text inside XML layout instead of doing this programmatically. It depends on our project. We also should turn off hardware acceleration for given activity in AndroidManifest.xml file in order to bring this solution to work.\n android:name=\".activity.justifiedTextViewActivity\" android:configChanges=\"orientation|keyboardHidden\" android:hardwareAccelerated=\"false\"/ That’s it. It’s not perfect solution and it’s kind of workaround, but I haven’t found any better idea how to deal with this problem. I tested a few solutions and this one is, in my opinion, the best available and most elegant option for now. Please note: There may be a problem with proper execution of this solution on Android OS version lower than 3.0 (API 11).\n","wordCount":"565","inLanguage":"en","datePublished":"2013-08-31T22:14:00Z","dateModified":"2013-08-31T22:14:00Z","author":{"@type":"Person","name":"Piotr Wittchen"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wittchen.io/posts/justifying-block-of-text-inside-textview-in-android/"},"publisher":{"@type":"Organization","name":"Piotr Wittchen","logo":{"@type":"ImageObject","url":"https://wittchen.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wittchen.io/ accesskey=h title="Piotr Wittchen (Alt + H)">Piotr Wittchen</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wittchen.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://wittchen.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://wittchen.io/talks/ title=talks><span>talks</span></a></li><li><a href=https://wittchen.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://wittchen.io/contact/ title=contact><span>contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wittchen.io/>Home</a>&nbsp;»&nbsp;<a href=https://wittchen.io/posts/>Posts</a></div><h1 class=post-title>Justifying block of text inside TextView in Android</h1><div class=post-meta><span title="2013-08-31 22:14:00 +0000 UTC">August 31, 2013</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;565 words&nbsp;·&nbsp;Piotr Wittchen&nbsp;|&nbsp;<a href=https://github.com/pwittchen/wittchen.io/blob/master/content/posts/justifying-block-of-text-inside-textview-in-android.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>Justifying text inside <code>TextView</code> in Android is not that simple as we may expect it to be. Unfortunately, Android does not have attribute for <code>TextView</code>, which supports justifying text. We can set alignment to the right or to the left, but we cannot simply justify text with generic attributes. In order to do that, we need to perform a few tricks. First of all, we need to create file named <code>justified_textview.css</code> and we need to put it into the <code>assets/</code> directory of our project. We will use it later in our custom view. Source code of this CSS stylesheet is presented below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=nt>body</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>font-size</span><span class=p>:</span> <span class=mf>1.0</span><span class=kt>em</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>color</span><span class=p>:</span> <span class=nb>rgb</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>text-align</span><span class=p>:</span> <span class=kc>justify</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c>/* background: rgba(217, 217, 217, 1.0);  you can set your background here,
</span></span></span><span class=line><span class=cl><span class=c>                                              it&#39;s kind of fix for older versions of Android OS */</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>@</span><span class=k>media</span> <span class=nt>screen</span> <span class=nt>and</span> <span class=o>(</span><span class=nt>-webkit-device-pixel-ratio</span><span class=o>:</span> <span class=nt>1</span><span class=p>.</span><span class=nc>5</span><span class=o>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c>/* CSS for high-density screens */</span>
</span></span><span class=line><span class=cl>    <span class=nt>body</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>font-size</span><span class=p>:</span> <span class=mf>1.05</span><span class=kt>em</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>@</span><span class=k>media</span> <span class=nt>screen</span> <span class=nt>and</span> <span class=o>(</span><span class=nt>-webkit-device-pixel-ratio</span><span class=o>:</span> <span class=nt>2</span><span class=p>.</span><span class=nc>0</span><span class=o>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c>/* CSS for extra high-density screens */</span>
</span></span><span class=line><span class=cl>    <span class=nt>body</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>font-size</span><span class=p>:</span> <span class=mf>1.1</span><span class=kt>em</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Next, we need to create class for customized view extending WebView. Let&rsquo;s call it <em>JustifiedTextView</em>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span> <span class=nn>com.github.sample.view</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>android.content.Context</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>android.content.res.TypedArray</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>android.graphics.Color</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>android.os.Build</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>android.text.TextUtils</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>android.util.AttributeSet</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>android.util.TypedValue</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>android.view.View</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>android.webkit.WebView</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>com.github.sample.R</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>JustifiedTextView</span> <span class=kd>extends</span> <span class=n>WebView</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>text</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>JustifiedTextView</span><span class=o>(</span><span class=kd>final</span> <span class=n>Context</span> <span class=n>context</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>(</span><span class=n>context</span><span class=o>,</span> <span class=kc>null</span><span class=o>,</span> <span class=n>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>JustifiedTextView</span><span class=o>(</span><span class=kd>final</span> <span class=n>Context</span> <span class=n>context</span><span class=o>,</span> <span class=kd>final</span> <span class=n>AttributeSet</span> <span class=n>attrs</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>(</span><span class=n>context</span><span class=o>,</span> <span class=n>attrs</span><span class=o>,</span> <span class=n>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>JustifiedTextView</span><span class=o>(</span><span class=kd>final</span> <span class=n>Context</span> <span class=n>context</span><span class=o>,</span> <span class=kd>final</span> <span class=n>AttributeSet</span> <span class=n>attrs</span><span class=o>,</span> <span class=kd>final</span> <span class=kt>int</span> <span class=n>defStyle</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>(</span><span class=n>context</span><span class=o>,</span> <span class=n>attrs</span><span class=o>,</span> <span class=n>defStyle</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>attrs</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=kd>final</span> <span class=n>TypedValue</span> <span class=n>typedValue</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TypedValue</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=kd>final</span> <span class=n>TypedArray</span> <span class=n>typedArray</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=na>obtainStyledAttributes</span><span class=o>(</span><span class=n>attrs</span><span class=o>,</span> <span class=n>R</span><span class=o>.</span><span class=na>styleable</span><span class=o>.</span><span class=na>JustifiedTextView</span><span class=o>,</span> <span class=n>defStyle</span><span class=o>,</span> <span class=n>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>(</span><span class=n>typedArray</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>typedArray</span><span class=o>.</span><span class=na>getValue</span><span class=o>(</span><span class=n>R</span><span class=o>.</span><span class=na>styleable</span><span class=o>.</span><span class=na>JustifiedTextView_text</span><span class=o>,</span> <span class=n>typedValue</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=o>(</span><span class=n>typedValue</span><span class=o>.</span><span class=na>resourceId</span> <span class=o>&gt;</span> <span class=n>0</span> <span class=o>&amp;&amp;</span> <span class=n>TextUtils</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>(</span><span class=n>text</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>text</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=na>getString</span><span class=o>(</span><span class=n>typedValue</span><span class=o>.</span><span class=na>resourceId</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>text</span><span class=o>.</span><span class=na>replace</span><span class=o>(</span><span class=s>&#34;\n&#34;</span><span class=o>,</span> <span class=s>&#34;&lt;br /&gt;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>loadDataWithBaseURL</span><span class=o>(</span><span class=s>&#34;file:///android_asset/&#34;</span><span class=o>,</span> <span class=s>&#34;&lt;html&gt;&lt;head&gt;&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                            <span class=s>&#34;&lt;link rel=\&#34;stylesheet\&#34; type=\&#34;text/css\&#34; href=\&#34;justified_textview.css\&#34; /&gt;&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                            <span class=s>&#34;&lt;/head&gt;&lt;body&gt;&#34;</span> <span class=o>+</span> <span class=n>text</span> <span class=o>+</span> <span class=s>&#34;&lt;/body&gt;&lt;/html&gt;&#34;</span><span class=o>,</span> <span class=s>&#34;text/html&#34;</span><span class=o>,</span> <span class=s>&#34;UTF8&#34;</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>setTransparentBackground</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setTransparentBackground</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>Build</span><span class=o>.</span><span class=na>VERSION</span><span class=o>.</span><span class=na>SDK_INT</span> <span class=o>&gt;=</span> <span class=n>11</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>setLayerType</span><span class=o>(</span><span class=n>View</span><span class=o>.</span><span class=na>LAYER_TYPE_SOFTWARE</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=kd>final</span> <span class=n>NoSuchMethodError</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Log</span><span class=o>.</span><span class=na>d</span><span class=o>(</span><span class=s>&#34;could not set layer&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>setBackgroundColor</span><span class=o>(</span><span class=n>Color</span><span class=o>.</span><span class=na>TRANSPARENT</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>setBackgroundDrawable</span><span class=o>(</span><span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>setBackgroundResource</span><span class=o>(</span><span class=n>0</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>getText</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>text</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setText</span><span class=o>(</span><span class=n>String</span> <span class=n>currentText</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>text</span> <span class=o>=</span> <span class=n>currentText</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span><span class=o>.</span><span class=na>replace</span><span class=o>(</span><span class=s>&#34;\n&#34;</span><span class=o>,</span> <span class=s>&#34;&lt;br /&gt;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>loadDataWithBaseURL</span><span class=o>(</span><span class=s>&#34;file:///android_asset/&#34;</span><span class=o>,</span> <span class=s>&#34;&lt;html&gt;&lt;head&gt;&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;&lt;link rel=\&#34;stylesheet\&#34; type=\&#34;text/css\&#34; href=\&#34;justified_textview.css\&#34; /&gt;&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=s>&#34;&lt;/head&gt;&lt;body&gt;&#34;</span> <span class=o>+</span> <span class=n>text</span> <span class=o>+</span> <span class=s>&#34;&lt;/body&gt;&lt;/html&gt;&#34;</span><span class=o>,</span> <span class=s>&#34;text/html&#34;</span><span class=o>,</span> <span class=s>&#34;UTF8&#34;</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>setTransparentBackground</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>After that, we need to update <code>res/values/attrs.xml</code> file and put inside the following declaration:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;declare-styleable</span> <span class=na>name=</span><span class=s>&#34;JustifiedTextView&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;attr</span> <span class=na>name=</span><span class=s>&#34;text&#34;</span> <span class=na>format=</span><span class=s>&#34;reference&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/declare-styleable&gt;</span>
</span></span></code></pre></div><p>Now, we are ready to use our custom <code>JustifiedTextView</code>. In order to do that, we need to create layout containing <code>JustifiedTextView</code> as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;com.github.sample.view.JustifiedTextView</span>
</span></span><span class=line><span class=cl>            <span class=na>android:id=</span><span class=s>&#34;@+id/tv_information&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>android:layout_width=</span><span class=s>&#34;wrap_content&#34;</span>
</span></span><span class=line><span class=cl><span class=na>android:layout_height=</span><span class=s>&#34;wrap_content&#34;</span> <span class=nt>/&gt;</span>
</span></span></code></pre></div><p>Next, we can access <code>JustifiedTextView</code> in our activity:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>private</span> <span class=n>JustifiedTextView</span> <span class=n>tvInformation</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>onCreate</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>tvInformation</span> <span class=o>=</span> <span class=o>(</span><span class=n>JustifiedTextView</span><span class=o>)</span> <span class=n>findViewById</span><span class=o>(</span><span class=n>R</span><span class=o>.</span><span class=na>id</span><span class=o>.</span><span class=na>tv_information</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>tVinformation</span><span class=o>.</span><span class=na>setText</span><span class=o>(</span><span class=s>&#34;sample text&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span></code></pre></div><p>We can also set text inside XML layout instead of doing this programmatically. It depends on our project. We also should turn off hardware acceleration for given activity in <code>AndroidManifest.xml</code> file in order to bring this solution to work.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;activity</span>
</span></span><span class=line><span class=cl>    <span class=na>android:name=</span><span class=s>&#34;.activity.justifiedTextViewActivity&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:configChanges=</span><span class=s>&#34;orientation|keyboardHidden&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>android:hardwareAccelerated=</span><span class=s>&#34;false&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></div><p>That&rsquo;s it. It&rsquo;s not perfect solution and it&rsquo;s kind of workaround, but I haven&rsquo;t found any better idea how to deal with this problem. I tested a few solutions and this one is, in my opinion, the best available and most elegant option for now. <strong>Please note: There may be a problem with proper execution of this solution on Android OS version lower than 3.0 (API 11).</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wittchen.io/tags/android/>android</a></li></ul><nav class=paginav><a class=prev href=https://wittchen.io/posts/how-to-connect-to-android-device-via-tcp-ip/><span class=title>« Prev</span><br><span>How to connect to Android device via TCP/IP?</span></a>
<a class=next href=https://wittchen.io/posts/asynchronous-loading-and-caching-bitmaps-with-volley/><span class=title>Next »</span><br><span>Asynchronous loading and caching bitmaps with Volley</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://wittchen.io/>Piotr Wittchen</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>