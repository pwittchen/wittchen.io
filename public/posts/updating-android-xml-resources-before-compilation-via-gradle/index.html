<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Updating Android XML resources before compilation via Gradle | Piotr Wittchen</title><meta name=keywords content="android,gradle,git"><meta name=description content="Problem In a team project, we encountered one of the common problems connected with mobile applications. Android application sends requests to backend web service and we don&rsquo;t have backend web service deployed right now on a separate server, so every mobile developer is compiling and running backend web service on the local machine for testing purposes. In the beginning, url of backend url looked as follows:
<?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?> <resources> <string name=&#34;backend_url&#34;>192."><meta name=author content="Piotr Wittchen"><link rel=canonical href=https://wittchen.io/posts/updating-android-xml-resources-before-compilation-via-gradle/><link crossorigin=anonymous href=/assets/css/stylesheet.cdcf872f971c70fddc7fd480e8457cd308ed0cf287b498bcdc6183fc6d147858.css integrity="sha256-zc+HL5cccP3cf9SA6EV80wjtDPKHtJi83GGD/G0UeFg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wittchen.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wittchen.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wittchen.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wittchen.io/apple-touch-icon.png><link rel=mask-icon href=https://wittchen.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Updating Android XML resources before compilation via Gradle"><meta property="og:description" content="Problem In a team project, we encountered one of the common problems connected with mobile applications. Android application sends requests to backend web service and we don&rsquo;t have backend web service deployed right now on a separate server, so every mobile developer is compiling and running backend web service on the local machine for testing purposes. In the beginning, url of backend url looked as follows:
<?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?> <resources> <string name=&#34;backend_url&#34;>192."><meta property="og:type" content="article"><meta property="og:url" content="https://wittchen.io/posts/updating-android-xml-resources-before-compilation-via-gradle/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-09-10T21:22:00+00:00"><meta property="article:modified_time" content="2014-09-10T21:22:00+00:00"><meta property="og:site_name" content="Piotr Wittchen"><meta name=twitter:card content="summary"><meta name=twitter:title content="Updating Android XML resources before compilation via Gradle"><meta name=twitter:description content="Problem In a team project, we encountered one of the common problems connected with mobile applications. Android application sends requests to backend web service and we don&rsquo;t have backend web service deployed right now on a separate server, so every mobile developer is compiling and running backend web service on the local machine for testing purposes. In the beginning, url of backend url looked as follows:
<?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?> <resources> <string name=&#34;backend_url&#34;>192."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wittchen.io/posts/"},{"@type":"ListItem","position":2,"name":"Updating Android XML resources before compilation via Gradle","item":"https://wittchen.io/posts/updating-android-xml-resources-before-compilation-via-gradle/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Updating Android XML resources before compilation via Gradle","name":"Updating Android XML resources before compilation via Gradle","description":"Problem In a team project, we encountered one of the common problems connected with mobile applications. Android application sends requests to backend web service and we don\u0026rsquo;t have backend web service deployed right now on a separate server, so every mobile developer is compiling and running backend web service on the local machine for testing purposes. In the beginning, url of backend url looked as follows:\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;utf-8\u0026#34;?\u0026gt; \u0026lt;resources\u0026gt; \u0026lt;string name=\u0026#34;backend_url\u0026#34;\u0026gt;192.","keywords":["android","gradle","git"],"articleBody":"Problem In a team project, we encountered one of the common problems connected with mobile applications. Android application sends requests to backend web service and we don’t have backend web service deployed right now on a separate server, so every mobile developer is compiling and running backend web service on the local machine for testing purposes. In the beginning, url of backend url looked as follows:\n   name=\"backend_url\"192.168.1.1  Of course address varies on different machines.\nWhen every developer was pushing changes, configuration of the backed url changed as well. It became annoying, so we decided to do something about that.\nSolution 1 Attempt #1 First, we came with an idea of ignoring local changes of the XML file, which contains backend url address. It can be done via Git in the following way:\ngit update-index --assume-unchanged [...] We can undo this operation with such command:\ngit update-index --assume-unchanged [...] We can also add ignored alias to our .gitconfig file:\n[alias] ignored = !git ls-files -v | grep \"^[[:lower:]]\" Then we can type: git ignored to display ignored files.\nFor more information check StackOverflow discussion.\nThis solution is kind of work-around, so we decided to do it better.\nAttempt #2 We could create alias for backend url and replace it before compilation dynamically via Gradle.\nOur new configuration file res/values/configuration.xml looks like that:\n   name=\"backend_url\"#const_backend_url#  Then, our build.gradle file needed to be updated. The most important part starts in 29th line, where #const_backend_url# value is replaced with an IP address of the local machine, where mobile application is compiled. As I mentioned before, backend web service application is compiled on the same machine, so backend web service address will be proper in that case for testing purposes.\napply plugin: 'com.android.application' android { compileSdkVersion 20 buildToolsVersion '20.0.0' compileOptions { sourceCompatibility JavaVersion.VERSION_1_7 targetCompatibility JavaVersion.VERSION_1_7 } defaultConfig { applicationId \"com.my.app\" minSdkVersion 15 targetSdkVersion 19 versionCode 1 versionName \"1.0\" testInstrumentationRunner \"com.google.android.apps.common.testing.testrunner.GoogleInstrumentationTestRunner\" } buildTypes { release { runProguard false proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro' } } // replace the #const_backend_url# with your current ip address to use your local backend web service  applicationVariants.all { variant - variant.mergeResources.doLast { def protocol = \"https://\" def localIp = obtainCurrentIpAddress() def port = \"8443\" def backendAddress = protocol + localIp + \":\" + port + \"/\" File valuesFile = file(\"${buildDir}/intermediates/res/${variant.dirName}/values/values.xml\") if(valuesFile.exists()) { String content = valuesFile.getText('UTF-8') content = content.replaceAll(\"#const_backend_url#\", backendAddress) valuesFile.write(content, 'UTF-8') println(\"Replacing #const_backend_url# with \" + backendAddress + \" in file: \" + valuesFile.name) } else { println(\"File: \" + valuesFile.path + \" does not exist\") } } } packagingOptions { exclude 'META-INF/DEPENDENCIES.txt' exclude 'META-INF/LICENSE.txt' exclude 'LICENSE.txt' exclude 'META-INF/NOTICE.txt' exclude 'META-INF/NOTICE' exclude 'META-INF/LICENSE' exclude 'META-INF/DEPENDENCIES' exclude 'META-INF/notice.txt' exclude 'META-INF/license.txt' exclude 'META-INF/dependencies.txt' exclude 'META-INF/LGPL2.1' exclude 'ASL-2.0.txt' exclude 'LGPL-3.0.txt' exclude 'META-INF/ASL-2.0.txt' exclude 'META-INF/LGPL-3.0.txt' exclude 'META-INF/services/javax.annotation.processing.Processor' } } dependencies { compile fileTree(dir: 'libs', include: ['*.jar']) compile 'com.jakewharton:butterknife:5.1.2' // put your another dependencies here  androidTestCompile 'com.jakewharton.espresso:espresso:1.1-r3' androidTestCompile 'com.squareup:fest-android:1.0.8' } def obtainCurrentIpAddress() { InetAddress inetAddress = InetAddress.getLocalHost(); byte[] address = inetAddress.getAddress(); String ipAddress = \"\"; for (int i = 0; i  address.length; i++) { if (i  0) { ipAddress += \".\"; } ipAddress += address[i] \u0026 0xFF; } ipAddress } Similar trick was applied in project: https://github.com/nenick/android-gradle-template in file https://github.com/nenick/android-gradle-template/blob/master/App/build.gradle, so you can check it out.\n","wordCount":"542","inLanguage":"en","datePublished":"2014-09-10T21:22:00Z","dateModified":"2014-09-10T21:22:00Z","author":{"@type":"Person","name":"Piotr Wittchen"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wittchen.io/posts/updating-android-xml-resources-before-compilation-via-gradle/"},"publisher":{"@type":"Organization","name":"Piotr Wittchen","logo":{"@type":"ImageObject","url":"https://wittchen.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wittchen.io/ accesskey=h title="Piotr Wittchen (Alt + H)">Piotr Wittchen</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wittchen.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://wittchen.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://wittchen.io/talks/ title=talks><span>talks</span></a></li><li><a href=https://wittchen.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://wittchen.io/contact/ title=contact><span>contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wittchen.io/>Home</a>&nbsp;»&nbsp;<a href=https://wittchen.io/posts/>Posts</a></div><h1 class=post-title>Updating Android XML resources before compilation via Gradle</h1><div class=post-meta><span title="2014-09-10 21:22:00 +0000 UTC">September 10, 2014</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;542 words&nbsp;·&nbsp;Piotr Wittchen&nbsp;|&nbsp;<a href=https://github.com/pwittchen/wittchen.io/blob/master/content/posts/updating-android-xml-resources-before-compilation-via-gradle.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h2 id=problem>Problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h2><p>In a team project, we encountered one of the common problems connected with mobile applications. Android application sends requests to backend web service and we don&rsquo;t have backend web service deployed right now on a separate server, so every mobile developer is compiling and running backend web service on the local machine for testing purposes. In the beginning, url of backend url looked as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;resources&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;string</span> <span class=na>name=</span><span class=s>&#34;backend_url&#34;</span><span class=nt>&gt;</span>192.168.1.1<span class=nt>&lt;/string&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/resources&gt;</span>
</span></span></code></pre></div><p>Of course address varies on different machines.</p><p>When every developer was pushing changes, configuration of the backed url changed as well. It became annoying, so we decided to do something about that.</p><h2 id=solution-1>Solution 1<a hidden class=anchor aria-hidden=true href=#solution-1>#</a></h2><h3 id=attempt-1>Attempt #1<a hidden class=anchor aria-hidden=true href=#attempt-1>#</a></h3><p>First, we came with an idea of ignoring local changes of the XML file, which contains backend url address.
It can be done via Git in the following way:</p><pre tabindex=0><code>git update-index --assume-unchanged [&lt;file&gt;...]
</code></pre><p>We can undo this operation with such command:</p><pre tabindex=0><code>git update-index --assume-unchanged [&lt;file&gt;...]
</code></pre><p>We can also add ignored alias to our .gitconfig file:</p><pre tabindex=0><code>[alias]
ignored = !git ls-files -v | grep &#34;^[[:lower:]]&#34;
</code></pre><p>Then we can type: git ignored to display ignored files.</p><p>For more information check <a href=http://stackoverflow.com/questions/1753070/git-ignore-files-only-locally>StackOverflow discussion</a>.</p><p>This solution is kind of work-around, so we decided to do it better.</p><h3 id=attempt-2>Attempt #2<a hidden class=anchor aria-hidden=true href=#attempt-2>#</a></h3><p>We could create alias for backend url and replace it before compilation dynamically via Gradle.</p><p>Our new configuration file <code>res/values/configuration.xml</code> looks like that:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;resources&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;string</span> <span class=na>name=</span><span class=s>&#34;backend_url&#34;</span><span class=nt>&gt;</span>#const_backend_url#<span class=nt>&lt;/string&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/resources&gt;</span>
</span></span></code></pre></div><p>Then, our <code>build.gradle</code> file needed to be updated. The most important part starts in 29th line, where <code>#const_backend_url#</code> value is replaced with an IP address of the local machine, where mobile application is compiled. As I mentioned before, backend web service application is compiled on the same machine, so backend web service address will be proper in that case for testing purposes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gradle data-lang=gradle><span class=line><span class=cl><span class=n>apply</span> <span class=nl>plugin:</span> <span class=s1>&#39;com.android.application&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>android</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>compileSdkVersion</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl>    <span class=n>buildToolsVersion</span> <span class=s1>&#39;20.0.0&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>compileOptions</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>sourceCompatibility</span> <span class=n>JavaVersion</span><span class=o>.</span><span class=na>VERSION_1_7</span>
</span></span><span class=line><span class=cl>        <span class=n>targetCompatibility</span> <span class=n>JavaVersion</span><span class=o>.</span><span class=na>VERSION_1_7</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>defaultConfig</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>applicationId</span> <span class=s2>&#34;com.my.app&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>minSdkVersion</span> <span class=mi>15</span>
</span></span><span class=line><span class=cl>        <span class=n>targetSdkVersion</span> <span class=mi>19</span>
</span></span><span class=line><span class=cl>        <span class=n>versionCode</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>versionName</span> <span class=s2>&#34;1.0&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>testInstrumentationRunner</span> <span class=s2>&#34;com.google.android.apps.common.testing.testrunner.GoogleInstrumentationTestRunner&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>buildTypes</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>release</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>runProguard</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>            <span class=n>proguardFiles</span> <span class=nf>getDefaultProguardFile</span><span class=o>(</span><span class=s1>&#39;proguard-android.txt&#39;</span><span class=o>),</span> <span class=s1>&#39;proguard-rules.pro&#39;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// replace the #const_backend_url# with your current ip address to use your local backend web service
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>applicationVariants</span><span class=o>.</span><span class=na>all</span> <span class=o>{</span> <span class=n>variant</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>        <span class=n>variant</span><span class=o>.</span><span class=na>mergeResources</span><span class=o>.</span><span class=na>doLast</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>def</span> <span class=n>protocol</span> <span class=o>=</span> <span class=s2>&#34;https://&#34;</span>
</span></span><span class=line><span class=cl>            <span class=kt>def</span> <span class=n>localIp</span> <span class=o>=</span> <span class=n>obtainCurrentIpAddress</span><span class=o>()</span>
</span></span><span class=line><span class=cl>            <span class=kt>def</span> <span class=n>port</span> <span class=o>=</span> <span class=s2>&#34;8443&#34;</span>
</span></span><span class=line><span class=cl>            <span class=kt>def</span> <span class=n>backendAddress</span> <span class=o>=</span> <span class=n>protocol</span> <span class=o>+</span> <span class=n>localIp</span> <span class=o>+</span> <span class=s2>&#34;:&#34;</span> <span class=o>+</span> <span class=n>port</span> <span class=o>+</span> <span class=s2>&#34;/&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>File</span> <span class=n>valuesFile</span> <span class=o>=</span> <span class=n>file</span><span class=o>(</span><span class=s2>&#34;${buildDir}/intermediates/res/${variant.dirName}/values/values.xml&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=o>(</span><span class=n>valuesFile</span><span class=o>.</span><span class=na>exists</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>String</span> <span class=n>content</span> <span class=o>=</span> <span class=n>valuesFile</span><span class=o>.</span><span class=na>getText</span><span class=o>(</span><span class=s1>&#39;UTF-8&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>content</span> <span class=o>=</span> <span class=n>content</span><span class=o>.</span><span class=na>replaceAll</span><span class=o>(</span><span class=s2>&#34;#const_backend_url#&#34;</span><span class=o>,</span> <span class=n>backendAddress</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>valuesFile</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>content</span><span class=o>,</span> <span class=s1>&#39;UTF-8&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=n>println</span><span class=o>(</span><span class=s2>&#34;Replacing #const_backend_url# with &#34;</span> <span class=o>+</span> <span class=n>backendAddress</span> <span class=o>+</span> <span class=s2>&#34; in file: &#34;</span> <span class=o>+</span> <span class=n>valuesFile</span><span class=o>.</span><span class=na>name</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>println</span><span class=o>(</span><span class=s2>&#34;File: &#34;</span> <span class=o>+</span> <span class=n>valuesFile</span><span class=o>.</span><span class=na>path</span> <span class=o>+</span> <span class=s2>&#34; does not exist&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>packagingOptions</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/DEPENDENCIES.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/LICENSE.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;LICENSE.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/NOTICE.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/NOTICE&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/LICENSE&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/DEPENDENCIES&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/notice.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/license.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/dependencies.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/LGPL2.1&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;ASL-2.0.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;LGPL-3.0.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/ASL-2.0.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/LGPL-3.0.txt&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>exclude</span> <span class=s1>&#39;META-INF/services/javax.annotation.processing.Processor&#39;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dependencies</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>compile</span> <span class=nf>fileTree</span><span class=o>(</span><span class=nl>dir:</span> <span class=s1>&#39;libs&#39;</span><span class=o>,</span> <span class=nl>include:</span> <span class=o>[</span><span class=s1>&#39;*.jar&#39;</span><span class=o>])</span>
</span></span><span class=line><span class=cl>    <span class=n>compile</span> <span class=s1>&#39;com.jakewharton:butterknife:5.1.2&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// put your another dependencies here
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>androidTestCompile</span> <span class=s1>&#39;com.jakewharton.espresso:espresso:1.1-r3&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>androidTestCompile</span> <span class=s1>&#39;com.squareup:fest-android:1.0.8&#39;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>def</span> <span class=nf>obtainCurrentIpAddress</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>InetAddress</span> <span class=n>inetAddress</span> <span class=o>=</span> <span class=n>InetAddress</span><span class=o>.</span><span class=na>getLocalHost</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>byte</span><span class=o>[]</span> <span class=n>address</span> <span class=o>=</span> <span class=n>inetAddress</span><span class=o>.</span><span class=na>getAddress</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>ipAddress</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>address</span><span class=o>.</span><span class=na>length</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span><span class=n>i</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>ipAddress</span> <span class=o>+=</span> <span class=s2>&#34;.&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=n>ipAddress</span> <span class=o>+=</span> <span class=n>address</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>&amp;</span> <span class=mh>0xFF</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>ipAddress</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>Similar trick was applied in project: <a href=https://github.com/nenick/android-gradle-template>https://github.com/nenick/android-gradle-template</a> in file <a href=https://github.com/nenick/android-gradle-template/blob/master/App/build.gradle>https://github.com/nenick/android-gradle-template/blob/master/App/build.gradle</a>, so you can check it out.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wittchen.io/tags/android/>android</a></li><li><a href=https://wittchen.io/tags/gradle/>gradle</a></li><li><a href=https://wittchen.io/tags/git/>git</a></li></ul><nav class=paginav><a class=prev href=https://wittchen.io/posts/versioning-android-applications/><span class=title>« Prev</span><br><span>Versioning Android applications</span></a>
<a class=next href=https://wittchen.io/posts/indicators-for-ubuntu/><span class=title>Next »</span><br><span>Indicators for Ubuntu</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://wittchen.io/>Piotr Wittchen</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>