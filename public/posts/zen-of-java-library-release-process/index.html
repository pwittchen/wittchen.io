<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Zen of the Java library release process | Piotr Wittchen</title><meta name=keywords content="java,gradle"><meta name=description content="In my previous article I published information about publishing JAR/AAR library to the Maven Central Repository. A few steps of that process were automated, but a few of them were still manual. I mean closing and release process which had to be done by manual clicking on the Sonatype website. Fortunately, it&rsquo;s possible to automate it. In order to do that, I used gradle-nexus-staging-plugin developed by Codearte. Thanks to this plugin I could get rid of the remaining manual steps left in the release process."><meta name=author content="Piotr Wittchen"><link rel=canonical href=https://wittchen.io/posts/zen-of-java-library-release-process/><link crossorigin=anonymous href=/assets/css/stylesheet.cdcf872f971c70fddc7fd480e8457cd308ed0cf287b498bcdc6183fc6d147858.css integrity="sha256-zc+HL5cccP3cf9SA6EV80wjtDPKHtJi83GGD/G0UeFg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wittchen.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wittchen.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wittchen.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wittchen.io/apple-touch-icon.png><link rel=mask-icon href=https://wittchen.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Zen of the Java library release process"><meta property="og:description" content="In my previous article I published information about publishing JAR/AAR library to the Maven Central Repository. A few steps of that process were automated, but a few of them were still manual. I mean closing and release process which had to be done by manual clicking on the Sonatype website. Fortunately, it&rsquo;s possible to automate it. In order to do that, I used gradle-nexus-staging-plugin developed by Codearte. Thanks to this plugin I could get rid of the remaining manual steps left in the release process."><meta property="og:type" content="article"><meta property="og:url" content="https://wittchen.io/posts/zen-of-java-library-release-process/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-06-08T10:58:10+00:00"><meta property="article:modified_time" content="2019-06-08T10:58:10+00:00"><meta property="og:site_name" content="Piotr Wittchen"><meta name=twitter:card content="summary"><meta name=twitter:title content="Zen of the Java library release process"><meta name=twitter:description content="In my previous article I published information about publishing JAR/AAR library to the Maven Central Repository. A few steps of that process were automated, but a few of them were still manual. I mean closing and release process which had to be done by manual clicking on the Sonatype website. Fortunately, it&rsquo;s possible to automate it. In order to do that, I used gradle-nexus-staging-plugin developed by Codearte. Thanks to this plugin I could get rid of the remaining manual steps left in the release process."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wittchen.io/posts/"},{"@type":"ListItem","position":2,"name":"Zen of the Java library release process","item":"https://wittchen.io/posts/zen-of-java-library-release-process/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Zen of the Java library release process","name":"Zen of the Java library release process","description":"In my previous article I published information about publishing JAR/AAR library to the Maven Central Repository. A few steps of that process were automated, but a few of them were still manual. I mean closing and release process which had to be done by manual clicking on the Sonatype website. Fortunately, it\u0026rsquo;s possible to automate it. In order to do that, I used gradle-nexus-staging-plugin developed by Codearte. Thanks to this plugin I could get rid of the remaining manual steps left in the release process.","keywords":["java","gradle"],"articleBody":"In my previous article I published information about publishing JAR/AAR library to the Maven Central Repository. A few steps of that process were automated, but a few of them were still manual. I mean closing and release process which had to be done by manual clicking on the Sonatype website. Fortunately, it’s possible to automate it. In order to do that, I used gradle-nexus-staging-plugin developed by Codearte. Thanks to this plugin I could get rid of the remaining manual steps left in the release process.\nPlease note, if you want to apply configuration described in this article to your project, you need to perform the steps described in the article about Publishing JAR/AAR to the Maven Central.\nIn my project, in the top-level build.gradle file I had to do the following setup:\napply plugin: 'io.codearte.nexus-staging' ... buildscript { repositories { google() jcenter() mavenCentral() maven { url 'https://plugins.gradle.org/m2/' } } dependencies { ... classpath \"io.codearte.gradle.nexus:gradle-nexus-staging-plugin:0.12.0\" } } ... def getRepositoryUsername() { return hasProperty('NEXUS_USERNAME') ? NEXUS_USERNAME : \"\" } def getRepositoryPassword() { return hasProperty('NEXUS_PASSWORD') ? NEXUS_PASSWORD : \"\" } nexusStaging { packageGroup = GROUP //optional if packageGroup == project.getGroup()  stagingProfileId = \"YOUR_STAGING_PROFILE\" //when not defined will be got from server using \"packageGroup\"  username = getRepositoryUsername() password = getRepositoryPassword() } In order to get YOUR_STAGING_PROFILE, we need to call the following command available in the plugin:\n./gradlew getStagingProfile When we are done, we can simply call:\n./gradlew uploadArchives closeAndReleaseRepository These two gradle tasks will upload our artifact, close and release it, so we won’t have to perform any manual steps in that process. After that, we just need to wait for the Maven sync as usual.\nMy complete release.sh script looks like that:\n#!/usr/bin/env bash ./gradlew clean build test check uploadArchives closeAndReleaseRepository Before upload and release, I also clean everything, build an artifact, run tests and static code analysis. It’s not required, but it’s good to do that.\nIf you are interested in complete project configuration, you can have a look at the https://github.com/pwittchen/ReactiveNetwork repository. It’s an Android library, but the same configuration can be applied to any JVM project built with Gradle. I have performed library release with this plugin a few times and it seems to work well.\n","wordCount":"367","inLanguage":"en","datePublished":"2019-06-08T10:58:10Z","dateModified":"2019-06-08T10:58:10Z","author":{"@type":"Person","name":"Piotr Wittchen"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wittchen.io/posts/zen-of-java-library-release-process/"},"publisher":{"@type":"Organization","name":"Piotr Wittchen","logo":{"@type":"ImageObject","url":"https://wittchen.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wittchen.io/ accesskey=h title="Piotr Wittchen (Alt + H)"><img src=https://wittchen.io/apple-touch-icon.png alt aria-label=logo height=35>Piotr Wittchen</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wittchen.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://wittchen.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://wittchen.io/talks/ title=talks><span>talks</span></a></li><li><a href=https://github.com/pwittchen title=code><span>code</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://wittchen.io/setup/ title=setup><span>setup</span></a></li><li><a href=https://wittchen.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://wittchen.io/contact/ title=contact><span>contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wittchen.io/>Home</a>&nbsp;»&nbsp;<a href=https://wittchen.io/posts/>Posts</a></div><h1 class=post-title>Zen of the Java library release process</h1><div class=post-meta><span title="2019-06-08 10:58:10 +0000 UTC">June 8, 2019</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;367 words&nbsp;·&nbsp;Piotr Wittchen&nbsp;|&nbsp;<a href=https://github.com/pwittchen/wittchen.io/blob/master/content/posts/zen-of-java-library-release-process.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>In my <a href=/publishing-jar-aar-to-maven-central/>previous article</a> I published information about publishing JAR/AAR library to the Maven Central Repository. A few steps of that process were automated, but a few of them were still manual. I mean closing and release process which had to be done by manual clicking on the Sonatype website. Fortunately, it&rsquo;s possible to automate it. In order to do that, I used <a href=https://github.com/Codearte/gradle-nexus-staging-plugin>gradle-nexus-staging-plugin</a> developed by <a href=https://github.com/Codearte>Codearte</a>. Thanks to this plugin I could get rid of the remaining manual steps left in the release process.</p><p><strong>Please note</strong>, if you want to apply configuration described in this article to your project, you need to perform the steps described in the article about <a href=/publishing-jar-aar-to-maven-central/>Publishing JAR/AAR to the Maven Central</a>.</p><p>In my project, in the top-level <a href=https://github.com/pwittchen/ReactiveNetwork/blob/RxJava2.x/build.gradle>build.gradle</a> file I had to do the following setup:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-gradle data-lang=gradle><span class=line><span class=cl><span class=n>apply</span> <span class=nl>plugin:</span> <span class=s1>&#39;io.codearte.nexus-staging&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>buildscript</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>repositories</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>google</span><span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=n>jcenter</span><span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=n>mavenCentral</span><span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=n>maven</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>url</span> <span class=s1>&#39;https://plugins.gradle.org/m2/&#39;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=n>dependencies</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=n>classpath</span> <span class=s2>&#34;io.codearte.gradle.nexus:gradle-nexus-staging-plugin:0.12.0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>def</span> <span class=nf>getRepositoryUsername</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nf>hasProperty</span><span class=o>(</span><span class=s1>&#39;NEXUS_USERNAME&#39;</span><span class=o>)</span> <span class=o>?</span> <span class=n>NEXUS_USERNAME</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>def</span> <span class=nf>getRepositoryPassword</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nf>hasProperty</span><span class=o>(</span><span class=s1>&#39;NEXUS_PASSWORD&#39;</span><span class=o>)</span> <span class=o>?</span> <span class=n>NEXUS_PASSWORD</span> <span class=o>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>nexusStaging</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>packageGroup</span> <span class=o>=</span> <span class=n>GROUP</span> <span class=c1>//optional if packageGroup == project.getGroup()
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>stagingProfileId</span> <span class=o>=</span> <span class=s2>&#34;YOUR_STAGING_PROFILE&#34;</span> <span class=c1>//when not defined will be got from server using &#34;packageGroup&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>username</span> <span class=o>=</span> <span class=n>getRepositoryUsername</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=n>password</span> <span class=o>=</span> <span class=n>getRepositoryPassword</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>In order to get <code>YOUR_STAGING_PROFILE</code>, we need to call the following command available in the plugin:</p><pre tabindex=0><code>./gradlew getStagingProfile
</code></pre><p>When we are done, we can simply call:</p><pre tabindex=0><code>./gradlew uploadArchives closeAndReleaseRepository
</code></pre><p>These two gradle tasks will upload our artifact, close and release it, so we won&rsquo;t have to perform any manual steps in that process. After that, we just need to wait for the Maven sync as usual.</p><p>My complete <code>release.sh</code> script looks like that:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/usr/bin/env bash
</span></span></span><span class=line><span class=cl><span class=cp></span>./gradlew clean build <span class=nb>test</span> check uploadArchives closeAndReleaseRepository
</span></span></code></pre></div><p>Before upload and release, I also clean everything, build an artifact, run tests and static code analysis. It&rsquo;s not required, but it&rsquo;s good to do that.</p><p>If you are interested in complete project configuration, you can have a look at the <a href=https://github.com/pwittchen/ReactiveNetwork>https://github.com/pwittchen/ReactiveNetwork</a> repository. It&rsquo;s an Android library, but the same configuration can be applied to any JVM project built with Gradle. I have performed library release with this plugin a few times and it seems to work well.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wittchen.io/tags/java/>java</a></li><li><a href=https://wittchen.io/tags/gradle/>gradle</a></li></ul><nav class=paginav><a class=prev href=https://wittchen.io/posts/arch-install-notes/><span class=title>« Prev</span><br><span>Arch Linux - installation notes</span></a>
<a class=next href=https://wittchen.io/posts/publishing-jar-aar-to-maven-central/><span class=title>Next »</span><br><span>Publishing a JAR/AAR to the Maven Central</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://wittchen.io/>Piotr Wittchen</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>